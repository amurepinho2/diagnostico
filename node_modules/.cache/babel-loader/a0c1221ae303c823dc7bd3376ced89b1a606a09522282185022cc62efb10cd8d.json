{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _react = require(\"react\");\nvar _rendererCore = require(\"@quillforms/renderer-core\");\nvar _lodash = require(\"lodash\");\nvar _choicesWrapper = _interopRequireDefault(require(\"./choices-wrapper\"));\n/**\r\n * QuillForms Depndencies\r\n */\n\n/**\r\n * WordPress Dependencies\r\n */\n\n/**\r\n * External Dependencies\r\n */\n\n/**\r\n * Internal Dependencies\r\n */\n\nlet multipleChoiceTimer;\nconst MultipleChoiceOutput = props => {\n  const {\n    id,\n    attributes,\n    setIsValid,\n    setIsAnswered,\n    showNextBtn,\n    setValidationErr,\n    val,\n    setVal,\n    next,\n    isAnswerLocked,\n    isActive,\n    isAnimating,\n    showErrMsg,\n    isPreview,\n    isReviewing,\n    setIsAnswerCorrect\n  } = props;\n  const {\n    multiple,\n    required,\n    min,\n    max\n  } = attributes;\n  const messages = (0, _rendererCore.useMessages)();\n  const correctIncorrectQuiz = (0, _rendererCore.useCorrectIncorrectQuiz)();\n  const [choiceClicked, setChoiceClicked] = (0, _react.useState)(null);\n  const checkfieldValidation = $val => {\n    if (required === true && (!$val || $val.length === 0)) {\n      setIsValid(false);\n      setValidationErr(messages['label.errorAlert.required']);\n    } else {\n      if ((0, _lodash.size)($val) > 0 && correctIncorrectQuiz?.enabled && correctIncorrectQuiz?.showAnswersDuringQuiz) {\n        // $val is array of selected choices\n        // const isCorrect = correctIncorrectQuiz?.questions?.[id]?.correctAnswers?.includes($val);\n        // if each value from $val includes any answer from those in the correctAnswers array, then it is correct, not the opposite.\n\n        const isCorrect = $val.every(answer => correctIncorrectQuiz?.questions?.[id]?.correctAnswers?.includes(answer));\n        // const isCorrect = correctIncorrectQuiz?.questions?.[id]?.correctAnswers?.every((answer) => $val.includes(answer));\n        setIsAnswerCorrect(isCorrect);\n      }\n      if (multiple && min && (0, _lodash.size)($val) < min) {\n        setIsValid(false);\n        setValidationErr(messages['label.errorAlert.minChoices']);\n      } else if (multiple && max && (0, _lodash.size)($val) > max) {\n        setIsValid(false);\n        setValidationErr(messages['label.errorAlert.maxChoices']);\n      } else {\n        setIsValid(true);\n        setValidationErr(null);\n      }\n    }\n  };\n  (0, _react.useEffect)(() => {\n    return () => clearTimeout(multipleChoiceTimer);\n  }, []);\n  (0, _react.useEffect)(() => {\n    if (!isActive) {\n      clearTimeout(multipleChoiceTimer);\n    }\n    if (!isActive && !isAnimating) {\n      setChoiceClicked(null);\n    }\n  }, [isActive, isAnimating]);\n  (0, _react.useEffect)(() => {\n    clearTimeout(multipleChoiceTimer);\n    if (choiceClicked && val?.length > 0 && !multiple) {\n      multipleChoiceTimer = setTimeout(() => {\n        next();\n      }, 600);\n    }\n  }, [choiceClicked]);\n  (0, _react.useEffect)(() => {\n    if (isPreview || !isReviewing) checkfieldValidation(val);\n  }, [attributes, correctIncorrectQuiz]);\n  (0, _react.useEffect)(() => {\n    if (val?.length > 0) {\n      setIsAnswered(true);\n    } else {\n      setIsAnswered(false);\n    }\n    if (multiple) {\n      if (val?.length > 0) {\n        showNextBtn(true);\n      }\n    }\n  }, [val, attributes]);\n  return (0, _react.createElement)(\"div\", {\n    className: \"qf-multiple-choice-block-renderer\"\n  }, (0, _react.createElement)(_choicesWrapper.default, {\n    attributes: attributes,\n    id: id,\n    val: val,\n    isActive: isActive,\n    isAnswerLocked: isAnswerLocked,\n    correctIncorrectQuiz: correctIncorrectQuiz,\n    checkfieldValidation: checkfieldValidation,\n    setVal: setVal,\n    setChoiceClicked: val => {\n      showErrMsg(false);\n      setChoiceClicked(val);\n    }\n  }));\n};\nvar _default = exports.default = MultipleChoiceOutput;","map":{"version":3,"names":["_react","require","_rendererCore","_lodash","_choicesWrapper","_interopRequireDefault","multipleChoiceTimer","MultipleChoiceOutput","props","id","attributes","setIsValid","setIsAnswered","showNextBtn","setValidationErr","val","setVal","next","isAnswerLocked","isActive","isAnimating","showErrMsg","isPreview","isReviewing","setIsAnswerCorrect","multiple","required","min","max","messages","useMessages","correctIncorrectQuiz","useCorrectIncorrectQuiz","choiceClicked","setChoiceClicked","useState","checkfieldValidation","$val","length","size","enabled","showAnswersDuringQuiz","isCorrect","every","answer","questions","correctAnswers","includes","useEffect","clearTimeout","setTimeout","createElement","className","default","_default","exports"],"sources":["/Users/amurepinho/Documents/GitHub/diagnostico/node_modules/@quillforms/blocklib-multiple-choice-block/build/renderer/@quillforms/blocklib-multiple-choice-block/src/renderer/display.js"],"sourcesContent":["/**\r\n * QuillForms Depndencies\r\n */\r\nimport { useMessages, useCorrectIncorrectQuiz } from '@quillforms/renderer-core';\r\n\r\n/**\r\n * WordPress Dependencies\r\n */\r\nimport { useEffect, useState } from 'react';\r\n\r\n/**\r\n * External Dependencies\r\n */\r\nimport { set, size } from 'lodash';\r\n\r\n/**\r\n * Internal Dependencies\r\n */\r\nimport ChoicesWrapper from './choices-wrapper';\r\n\r\nlet multipleChoiceTimer;\r\nconst MultipleChoiceOutput = (props) => {\r\n\tconst {\r\n\t\tid,\r\n\t\tattributes,\r\n\t\tsetIsValid,\r\n\t\tsetIsAnswered,\r\n\t\tshowNextBtn,\r\n\t\tsetValidationErr,\r\n\t\tval,\r\n\t\tsetVal,\r\n\t\tnext,\r\n\t\tisAnswerLocked,\r\n\t\tisActive,\r\n\t\tisAnimating,\r\n\t\tshowErrMsg,\r\n\t\tisPreview,\r\n\t\tisReviewing,\r\n\t\tsetIsAnswerCorrect\r\n\t} = props;\r\n\tconst { multiple, required, min, max } = attributes;\r\n\tconst messages = useMessages();\r\n\tconst correctIncorrectQuiz = useCorrectIncorrectQuiz();\r\n\tconst [choiceClicked, setChoiceClicked] = useState(null);\r\n\tconst checkfieldValidation = ($val) => {\r\n\t\tif (required === true && (!$val || $val.length === 0)) {\r\n\t\t\tsetIsValid(false);\r\n\t\t\tsetValidationErr(messages['label.errorAlert.required']);\r\n\t\t} else {\r\n\t\t\tif (size($val) > 0 && correctIncorrectQuiz?.enabled && correctIncorrectQuiz?.showAnswersDuringQuiz) {\r\n\t\t\t\t// $val is array of selected choices\r\n\t\t\t\t// const isCorrect = correctIncorrectQuiz?.questions?.[id]?.correctAnswers?.includes($val);\r\n\t\t\t\t// if each value from $val includes any answer from those in the correctAnswers array, then it is correct, not the opposite.\r\n\r\n\t\t\t\tconst isCorrect = $val.every((answer) => correctIncorrectQuiz?.questions?.[id]?.correctAnswers?.includes(answer));\r\n\t\t\t\t// const isCorrect = correctIncorrectQuiz?.questions?.[id]?.correctAnswers?.every((answer) => $val.includes(answer));\r\n\t\t\t\tsetIsAnswerCorrect(isCorrect);\r\n\t\t\t}\r\n\t\t\tif (multiple && min && size($val) < min) {\r\n\t\t\t\tsetIsValid(false);\r\n\t\t\t\tsetValidationErr(messages['label.errorAlert.minChoices']);\r\n\t\t\t}\r\n\t\t\telse if (multiple && max && size($val) > max) {\r\n\t\t\t\tsetIsValid(false);\r\n\t\t\t\tsetValidationErr(messages['label.errorAlert.maxChoices']);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tsetIsValid(true);\r\n\t\t\t\tsetValidationErr(null);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tuseEffect(() => {\r\n\t\treturn () => clearTimeout(multipleChoiceTimer);\r\n\t}, []);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!isActive) {\r\n\t\t\tclearTimeout(multipleChoiceTimer);\r\n\t\t}\r\n\t\tif (!isActive && !isAnimating) {\r\n\t\t\tsetChoiceClicked(null);\r\n\t\t}\r\n\t}, [isActive, isAnimating]);\r\n\r\n\tuseEffect(() => {\r\n\t\tclearTimeout(multipleChoiceTimer);\r\n\t\tif (choiceClicked && val?.length > 0 && !multiple) {\r\n\t\t\tmultipleChoiceTimer = setTimeout(() => {\r\n\t\t\t\tnext();\r\n\t\t\t}, 600);\r\n\t\t}\r\n\t}, [choiceClicked]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (isPreview || !isReviewing) checkfieldValidation(val);\r\n\t}, [attributes, correctIncorrectQuiz]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (val?.length > 0) {\r\n\t\t\tsetIsAnswered(true);\r\n\t\t} else {\r\n\t\t\tsetIsAnswered(false);\r\n\t\t}\r\n\t\tif (multiple) {\r\n\t\t\tif (val?.length > 0) {\r\n\t\t\t\tshowNextBtn(true);\r\n\t\t\t}\r\n\t\t}\r\n\t}, [val, attributes]);\r\n\r\n\treturn (\r\n\t\t<div className=\"qf-multiple-choice-block-renderer\">\r\n\t\t\t<ChoicesWrapper\r\n\t\t\t\tattributes={attributes}\r\n\t\t\t\tid={id}\r\n\t\t\t\tval={val}\r\n\t\t\t\tisActive={isActive}\r\n\t\t\t\tisAnswerLocked={isAnswerLocked}\r\n\t\t\t\tcorrectIncorrectQuiz={correctIncorrectQuiz}\r\n\t\t\t\tcheckfieldValidation={checkfieldValidation}\r\n\t\t\t\tsetVal={setVal}\r\n\t\t\t\tsetChoiceClicked={(val) => {\r\n\t\t\t\t\tshowErrMsg(false);\r\n\t\t\t\t\tsetChoiceClicked(val);\r\n\t\t\t\t}}\r\n\t\t\t/>\r\n\t\t</div>\r\n\t);\r\n};\r\nexport default MultipleChoiceOutput;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}