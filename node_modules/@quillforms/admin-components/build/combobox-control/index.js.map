{"version":3,"names":["_react","require","_hooks","_context","_richText","_interopRequireDefault","_select","_useFields","_useHiddenFields","_useVariables","ComboboxControl","id","value","onChange","isToggleEnabled","customize","placeholder","hideChooseOption","selectFirstOption","excerptLength","allowedFormats","fields","useFields","section","variables","useVariables","hidden_fields","useHiddenFields","sections","options","length","push","key","label","concat","EntryProperties","map","property","type","isMergeTag","filtered","applyFilters","customized","useEffect","createElement","className","ComboboxControlContextProvider","default","_default","exports"],"sources":["@quillforms/admin-components/src/combobox-control/index.tsx"],"sourcesContent":["/**\n * QuillForms Dependencies\n */\nimport { IconRenderer } from '@quillforms/types';\n\n/**\n * WordPress Dependencies\n */\nimport { applyFilters } from '@wordpress/hooks';\nimport { useEffect } from 'react';\nimport { allowedFormats } from '../rich-text';\n\n/**\n * Internal Dependencies\n */\nimport { ComboboxControlContextProvider } from './context';\nimport RichText from './rich-text';\nimport Select from './select';\nimport useFields from './use-fields';\nimport useHiddenFields from './use-hidden-fields';\nimport useVariables from './use-variables';\n\nexport type Sections = { key: string; label: string }[];\nexport type Options = {\n\ttype: string;\n\tvalue: string;\n\tlabel: string;\n\ticonBox?: {\n\t\ticon?: IconRenderer;\n\t\tcolor?: string;\n\t};\n\t// section must exist if defined.\n\tsection?: string;\n\t// will the option be included in rich text editor merge tags?\n\tisMergeTag?: boolean;\n\t// can hold other data for filters like block name.\n\tother?: {\n\t\t[ x: string ]: any;\n\t};\n}[];\nexport type ComboboxControlValue = {\n\ttype?: string;\n\tvalue?: string;\n};\nexport type CustomizeObject = {\n\tsections: Sections;\n\toptions: Options;\n};\nexport type CustomizeFunction = ( value: CustomizeObject ) => CustomizeObject;\n\nexport type ComboboxControlProps = {\n\tid?: string;\n\t// if type is text, the component will load rich text editor. else the component will load the select.\n\tvalue: ComboboxControlValue;\n\tonChange: ( value: ComboboxControlValue ) => void;\n\t// if true, select component will have custom value option that loads rich text\n\t// and rich text editor will have back/exit button to loads select. (default true)\n\tisToggleEnabled?: boolean;\n\t// customize sections and options.\n\tcustomize?: CustomizeFunction;\n\t// rich text editor placeholder or select \"choose\" option text.\n\tplaceholder?: string;\n\t// hide \"choose an option\". (select)\n\thideChooseOption?: boolean;\n\t// select first option on load if value is empty. calls onChange. (select)\n\tselectFirstOption?: boolean;\n\t// Excerpt length\n\texcerptLength?: number;\n\t// allowed formats (rich text).\n\tallowedFormats?: allowedFormats;\n};\n\nconst ComboboxControl: React.FC< ComboboxControlProps > = ( {\n\tid,\n\tvalue,\n\tonChange,\n\tisToggleEnabled = true,\n\tcustomize,\n\tplaceholder,\n\thideChooseOption,\n\tselectFirstOption,\n\texcerptLength = 30,\n\tallowedFormats,\n} ) => {\n\tconst fields = useFields( { section: 'fields' } );\n\tconst variables = useVariables( { section: 'variables' } );\n\tconst hidden_fields = useHiddenFields( { section: 'hidden_fields' } );\n\n\tlet sections: Sections = [];\n\tlet options: Options = [];\n\n\t// fields\n\tif ( fields.length ) {\n\t\tsections.push( {\n\t\t\tkey: 'fields',\n\t\t\tlabel: 'Fields',\n\t\t} );\n\t\toptions = options.concat( fields );\n\t}\n\t// variables\n\tif ( variables.length ) {\n\t\tsections.push( {\n\t\t\tkey: 'variables',\n\t\t\tlabel: 'Variables',\n\t\t} );\n\t\toptions = options.concat( variables );\n\t}\n\t// hidden_fields\n\tif ( hidden_fields.length ) {\n\t\tsections.push( {\n\t\t\tkey: 'hidden_fields',\n\t\t\tlabel: 'Hidden Fields',\n\t\t} );\n\t\toptions = options.concat( hidden_fields );\n\t}\n\t// entry properties\n\tconst EntryProperties = [\n\t\t{\n\t\t\tvalue: 'id',\n\t\t\tlabel: 'Entry ID',\n\t\t},\n\t\t{\n\t\t\tvalue: 'form_id',\n\t\t\tlabel: 'Form ID',\n\t\t},\n\t\t{\n\t\t\tvalue: 'date_created',\n\t\t\tlabel: 'Entry Date (YYYY-MM-DD)',\n\t\t},\n\t\t{\n\t\t\tvalue: 'user_id',\n\t\t\tlabel: 'User ID',\n\t\t},\n\t\t{\n\t\t\tvalue: 'user_ip',\n\t\t\tlabel: 'User IP Address',\n\t\t},\n\t\t{\n\t\t\tvalue: 'user_agent',\n\t\t\tlabel: 'HTTP User Agent',\n\t\t},\n\t];\n\tsections.push( {\n\t\tkey: 'entry_properties',\n\t\tlabel: 'Entry Properties',\n\t} );\n\toptions = options.concat(\n\t\tEntryProperties.map( ( property ) => {\n\t\t\treturn {\n\t\t\t\ttype: 'property',\n\t\t\t\tvalue: property.value,\n\t\t\t\tlabel: property.label,\n\t\t\t\tsection: 'entry_properties',\n\t\t\t\tisMergeTag: true,\n\t\t\t};\n\t\t} )\n\t);\n\n\t// apply global customize filter to sections and options.\n\tconst filtered = applyFilters(\n\t\t'QuillForms.AdminComponents.ComboboxControl.Customize',\n\t\t{ sections, options }\n\t) as CustomizeObject;\n\tsections = filtered.sections;\n\toptions = filtered.options;\n\n\t// apply local customize filter to sections and options.\n\tif ( customize ) {\n\t\tconst customized = customize( { sections, options } );\n\t\tsections = customized.sections;\n\t\toptions = customized.options;\n\t}\n\n\t// select first option.\n\tuseEffect( () => {\n\t\tif (\n\t\t\tselectFirstOption &&\n\t\t\t! value.type &&\n\t\t\t! value.value &&\n\t\t\toptions[ 0 ]\n\t\t) {\n\t\t\tonChange( { type: options[ 0 ].type, value: options[ 0 ].value } );\n\t\t}\n\t}, [] );\n\n\treturn (\n\t\t<div className=\"combobox-control\">\n\t\t\t<ComboboxControlContextProvider\n\t\t\t\tvalue={ {\n\t\t\t\t\tid,\n\t\t\t\t\tsections,\n\t\t\t\t\toptions,\n\t\t\t\t\tvalue,\n\t\t\t\t\tonChange,\n\t\t\t\t\tisToggleEnabled,\n\t\t\t\t\tplaceholder,\n\t\t\t\t\texcerptLength,\n\t\t\t\t} }\n\t\t\t>\n\t\t\t\t{ value.type === 'text' ? (\n\t\t\t\t\t<RichText allowedFormats={ allowedFormats } />\n\t\t\t\t) : (\n\t\t\t\t\t<Select hideChooseOption={ hideChooseOption } />\n\t\t\t\t) }\n\t\t\t</ComboboxControlContextProvider>\n\t\t</div>\n\t);\n};\n\nexport default ComboboxControl;\n"],"mappings":"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","ignoreList":[]}