{"version":3,"names":["_utils","require","_data","_lodash","_richText","useFields","section","blockTypes","formBlocks","useSelect","select","getBlockTypes","getBlocks","blocks","size","forEach","block","index","name","supports","editable","push","order","innerBlocks","childBlock","childIndex","identAlphabetically","parseInt","fields","blockType","type","value","id","label","attributes","getPlainExcerpt","iconBox","icon","color","isMergeTag","other","_default","exports","default"],"sources":["@quillforms/admin-components/src/combobox-control/use-fields.ts"],"sourcesContent":["/**\n * Quill Forms Dependencies\n */\n\nimport { identAlphabetically } from '@quillforms/utils';\n\n/**\n * WordPress Dependencies\n */\nimport { useSelect } from '@wordpress/data';\n\n/**\n * External Dependencies\n */\nimport { forEach, size } from 'lodash';\n\n/**\n * Internal Dependencies\n */\nimport type { Options } from '.';\nimport { getPlainExcerpt } from '../rich-text';\nimport { FormBlocks } from '@quillforms/types/src';\n\nconst useFields = ( { section } ) => {\n\tconst { blockTypes, formBlocks } = useSelect( ( select ) => {\n\t\treturn {\n\t\t\tblockTypes: select( 'quillForms/blocks' ).getBlockTypes(),\n\t\t\t// @ts-expect-error\n\t\t\tformBlocks: select( 'quillForms/block-editor' ).getBlocks(),\n\t\t};\n\t} );\n\tconst blocks: FormBlocks = [];\n\n\tif ( size( formBlocks ) > 0 ) {\n\t\tforEach( formBlocks, ( block, index ) => {\n\t\t\tif ( blockTypes[ block.name ]?.supports?.editable ) {\n\t\t\t\tblocks.push( { ...block, order: index } );\n\t\t\t}\n\t\t\tif ( blockTypes[ block.name ]?.supports?.innerBlocks ) {\n\t\t\t\tif ( size( block?.innerBlocks ) > 0 ) {\n\t\t\t\t\tforEach( block.innerBlocks, ( childBlock, childIndex ) => {\n\t\t\t\t\t\tblocks.push( {\n\t\t\t\t\t\t\t...childBlock,\n\t\t\t\t\t\t\torder:\n\t\t\t\t\t\t\t\tindex +\n\t\t\t\t\t\t\t\tidentAlphabetically( parseInt( childIndex ) ),\n\t\t\t\t\t\t} );\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t}\n\t\t} );\n\t}\n\tconst fields: Options = [];\n\tif ( size( blocks ) > 0 ) {\n\t\tfor ( const block of blocks ) {\n\t\t\tconst blockType = blockTypes[ block.name ];\n\t\t\tfields.push( {\n\t\t\t\ttype: 'field',\n\t\t\t\tvalue: block.id,\n\t\t\t\tlabel: block.attributes?.label\n\t\t\t\t\t? getPlainExcerpt( block.attributes.label )\n\t\t\t\t\t: '',\n\t\t\t\ticonBox: {\n\t\t\t\t\ticon: blockType?.icon,\n\t\t\t\t\tcolor: blockType?.color,\n\t\t\t\t},\n\t\t\t\tsection,\n\t\t\t\tisMergeTag: true,\n\t\t\t\tother: {\n\t\t\t\t\tname: block.name,\n\t\t\t\t},\n\t\t\t} );\n\t\t}\n\t}\n\n\treturn fields;\n};\n\nexport default useFields;\n"],"mappings":";;;;;;AAIA,IAAAA,MAAA,GAAAC,OAAA;AAKA,IAAAC,KAAA,GAAAD,OAAA;AAKA,IAAAE,OAAA,GAAAF,OAAA;AAMA,IAAAG,SAAA,GAAAH,OAAA;AApBA;AACA;AACA;;AAIA;AACA;AACA;;AAGA;AACA;AACA;;AAUA,MAAMI,SAAS,GAAGA,CAAE;EAAEC;AAAQ,CAAC,KAAM;EACpC,MAAM;IAAEC,UAAU;IAAEC;EAAW,CAAC,GAAG,IAAAC,eAAS,EAAIC,MAAM,IAAM;IAC3D,OAAO;MACNH,UAAU,EAAEG,MAAM,CAAE,mBAAoB,CAAC,CAACC,aAAa,CAAC,CAAC;MACzD;MACAH,UAAU,EAAEE,MAAM,CAAE,yBAA0B,CAAC,CAACE,SAAS,CAAC;IAC3D,CAAC;EACF,CAAE,CAAC;EACH,MAAMC,MAAkB,GAAG,EAAE;EAE7B,IAAK,IAAAC,YAAI,EAAEN,UAAW,CAAC,GAAG,CAAC,EAAG;IAC7B,IAAAO,eAAO,EAAEP,UAAU,EAAE,CAAEQ,KAAK,EAAEC,KAAK,KAAM;MACxC,IAAKV,UAAU,CAAES,KAAK,CAACE,IAAI,CAAE,EAAEC,QAAQ,EAAEC,QAAQ,EAAG;QACnDP,MAAM,CAACQ,IAAI,CAAE;UAAE,GAAGL,KAAK;UAAEM,KAAK,EAAEL;QAAM,CAAE,CAAC;MAC1C;MACA,IAAKV,UAAU,CAAES,KAAK,CAACE,IAAI,CAAE,EAAEC,QAAQ,EAAEI,WAAW,EAAG;QACtD,IAAK,IAAAT,YAAI,EAAEE,KAAK,EAAEO,WAAY,CAAC,GAAG,CAAC,EAAG;UACrC,IAAAR,eAAO,EAAEC,KAAK,CAACO,WAAW,EAAE,CAAEC,UAAU,EAAEC,UAAU,KAAM;YACzDZ,MAAM,CAACQ,IAAI,CAAE;cACZ,GAAGG,UAAU;cACbF,KAAK,EACJL,KAAK,GACL,IAAAS,0BAAmB,EAAEC,QAAQ,CAAEF,UAAW,CAAE;YAC9C,CAAE,CAAC;UACJ,CAAE,CAAC;QACJ;MACD;IACD,CAAE,CAAC;EACJ;EACA,MAAMG,MAAe,GAAG,EAAE;EAC1B,IAAK,IAAAd,YAAI,EAAED,MAAO,CAAC,GAAG,CAAC,EAAG;IACzB,KAAM,MAAMG,KAAK,IAAIH,MAAM,EAAG;MAC7B,MAAMgB,SAAS,GAAGtB,UAAU,CAAES,KAAK,CAACE,IAAI,CAAE;MAC1CU,MAAM,CAACP,IAAI,CAAE;QACZS,IAAI,EAAE,OAAO;QACbC,KAAK,EAAEf,KAAK,CAACgB,EAAE;QACfC,KAAK,EAAEjB,KAAK,CAACkB,UAAU,EAAED,KAAK,GAC3B,IAAAE,yBAAe,EAAEnB,KAAK,CAACkB,UAAU,CAACD,KAAM,CAAC,GACzC,EAAE;QACLG,OAAO,EAAE;UACRC,IAAI,EAAER,SAAS,EAAEQ,IAAI;UACrBC,KAAK,EAAET,SAAS,EAAES;QACnB,CAAC;QACDhC,OAAO;QACPiC,UAAU,EAAE,IAAI;QAChBC,KAAK,EAAE;UACNtB,IAAI,EAAEF,KAAK,CAACE;QACb;MACD,CAAE,CAAC;IACJ;EACD;EAEA,OAAOU,MAAM;AACd,CAAC;AAAC,IAAAa,QAAA,GAAAC,OAAA,CAAAC,OAAA,GAEatC,SAAS","ignoreList":[]}