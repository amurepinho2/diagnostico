"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var _autop = require("@wordpress/autop");
var _escapeHtml = _interopRequireDefault(require("escape-html"));
var _slate = require("slate");
var _lodash = require("lodash");
/**
 * WordPress Dependencies
 */

/**
 * External Dependencies
 */

const htmlSerialize = value => {
  return (0, _autop.removep)(serialize(value));
};
const serialize = node => {
  let nodeText = (0, _escapeHtml.default)(node.text);
  if (_slate.Text.isText(node)) {
    if (node.bold) {
      nodeText = `<strong>` + nodeText + `</strong>`;
    }
    if (node.italic) {
      nodeText = `<em>` + nodeText + `</em>`;
    }
    if (nodeText === '') {
      return '<br />';
    }
    return nodeText;
  }
  if (Array.isArray(node)) {
    return node.map(subNode => {
      return serializeNode(subNode);
    }).join('');
  }
  return serializeNode(node);
};
const serializeNode = node => {
  const children = (0, _lodash.size)(node.children) > 0 ? node.children.map(n => serialize(n)).join('') : '';
  switch (node.type) {
    case 'link':
      return `<a target="_blank" href="${(0, _escapeHtml.default)(node.url)}">${children}</a>`;
    case 'mergeTag':
      return `{{${node.data.type}:${node.data.modifier}}}`;
    case 'paragraph':
      return `<p>${children}</p>`;
    default:
      return `${children}`;
  }
};
var _default = exports.default = htmlSerialize;
//# sourceMappingURL=html-serialize.js.map