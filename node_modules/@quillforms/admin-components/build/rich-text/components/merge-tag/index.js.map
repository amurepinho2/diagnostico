{"version":3,"names":["_react","require","_components","_icons","_slate","_classnames","_interopRequireDefault","_emotion","_getPlainExcerpt","EditorMergeTag","attributes","editor","children","path","element","mergeTags","type","modifier","data","node","Editor","mergeTag","find","a","mergeTagIcon","icon","plus","renderedIcon","createElement","Icon","src","useEffect","apply","Transforms","insertNodes","text","at","Fragment","contentEditable","className","classnames","css","color","dangerouslySetInnerHTML","__html","getPlainExcerpt","label","onClick","setTimeout","close","_default","exports","default"],"sources":["@quillforms/admin-components/src/rich-text/components/merge-tag/index.tsx"],"sourcesContent":["/**\n * QuillForms Dependencies\n */\nimport type { IconDescriptor, Icon as IconType } from '@quillforms/types';\n/**\n * WordPress Dependencies\n */\nimport { useEffect } from 'react';\n// @ts-expect-error\nimport { Icon, Dashicon } from '@wordpress/components';\nimport { plus, close } from '@wordpress/icons';\n\n/**\n * External Dependencies\n */\nimport { Editor, Path, Transforms } from 'slate';\nimport classnames from 'classnames';\nimport { css } from 'emotion';\nimport { ReactEditor, RenderElementProps } from 'slate-react';\n\n/**\n * Internal Dependencies\n */\nimport getPlainExcerpt from '../../get-plain-excerpt';\nimport type { MergeTags, MergeTag, CustomElement } from '../../types';\n\ninterface Props extends RenderElementProps {\n\tpath: Path;\n\tmergeTags: MergeTags;\n\teditor: ReactEditor;\n\tchildren: React.ReactNode;\n\telement: CustomElement;\n}\nconst EditorMergeTag: React.FC<Props> = ({\n\tattributes,\n\teditor,\n\tchildren,\n\tpath,\n\telement,\n\tmergeTags,\n}) => {\n\tconst { type, modifier } = element.data as MergeTag;\n\tconst [node] = Editor.node(editor, path);\n\n\tconst mergeTag = mergeTags.find(\n\t\t(a) => a.type === type && a.modifier === modifier\n\t);\n\tconst mergeTagIcon = mergeTag?.icon ? mergeTag.icon : plus;\n\tconst renderedIcon = (\n\t\t<Icon\n\t\t\ticon={\n\t\t\t\t((mergeTagIcon as IconDescriptor)?.src as IconType)\n\t\t\t\t\t? ((mergeTagIcon as IconDescriptor)?.src as IconType)\n\t\t\t\t\t// @ts-expect-error\n\t\t\t\t\t: (mergeTagIcon as Dashicon.Icon)\n\t\t\t}\n\t\t/>\n\t);\n\n\tuseEffect(() => {\n\t\tif (!mergeTag) {\n\t\t\teditor.apply({ type: 'remove_node', path, node });\n\t\t\tTransforms.insertNodes(\n\t\t\t\teditor,\n\t\t\t\t{\n\t\t\t\t\ttext: `{{${type}:${modifier}}}`,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tat: path,\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t}, []);\n\treturn (\n\t\t<>\n\t\t\t{mergeTag && (\n\t\t\t\t<span\n\t\t\t\t\t{...attributes}\n\t\t\t\t\tcontentEditable={false}\n\t\t\t\t\tclassName={classnames(\n\t\t\t\t\t\t'rich-text-merge-tag__node-wrapper',\n\t\t\t\t\t\tcss`\n\t\t\t\t\t\t\tcolor: ${mergeTag?.color\n\t\t\t\t\t\t\t\t? mergeTag.color\n\t\t\t\t\t\t\t\t: '#bb426f'};\n\t\t\t\t\t\t\tbordercolor: ${mergeTag?.color\n\t\t\t\t\t\t\t\t? mergeTag.color\n\t\t\t\t\t\t\t\t: '#bb426f'};\n\t\t\t\t\t\t\tfill: ${mergeTag?.color\n\t\t\t\t\t\t\t\t? mergeTag.color\n\t\t\t\t\t\t\t\t: '#bb426f'};\n\t\t\t\t\t\t`\n\t\t\t\t\t)}\n\t\t\t\t>\n\t\t\t\t\t<span\n\t\t\t\t\t\tclassName={classnames(\n\t\t\t\t\t\t\t'rich-text-merge-tag__background',\n\t\t\t\t\t\t\tcss`\n\t\t\t\t\t\t\t\tbackground: ${mergeTag?.color\n\t\t\t\t\t\t\t\t\t? mergeTag.color\n\t\t\t\t\t\t\t\t\t: '#bb426f'};\n\t\t\t\t\t\t\t`\n\t\t\t\t\t\t)}\n\t\t\t\t\t/>\n\t\t\t\t\t<span className=\"rich-text-merge-tag__icon-box\">\n\t\t\t\t\t\t{renderedIcon}\n\t\t\t\t\t</span>\n\t\t\t\t\t<span\n\t\t\t\t\t\tclassName=\"rich-text-merge-tag__title\"\n\t\t\t\t\t\tdangerouslySetInnerHTML={{\n\t\t\t\t\t\t\t__html: getPlainExcerpt(mergeTag.label),\n\t\t\t\t\t\t}}\n\t\t\t\t\t/>\n\n\t\t\t\t\t<button\n\t\t\t\t\t\tclassName=\"rich-text-merge-tag__delete\"\n\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\teditor.apply({\n\t\t\t\t\t\t\t\t\ttype: 'remove_node',\n\t\t\t\t\t\t\t\t\tpath,\n\t\t\t\t\t\t\t\t\tnode,\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}, 0);\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<Icon icon={close} />\n\t\t\t\t\t</button>\n\t\t\t\t\t{children}\n\t\t\t\t</span>\n\t\t\t)}\n\t\t</>\n\t);\n};\nexport default EditorMergeTag;\n"],"mappings":"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","ignoreList":[]}