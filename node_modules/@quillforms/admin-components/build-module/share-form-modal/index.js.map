{"version":3,"names":["useEffect","useState","useSelect","apiFetch","addQueryArgs","buildQueryString","Modal","css","classnames","LinkPlaceholder","ShareFormModal","formId","closeModal","isFetching","setIsFetching","permalink","setPermalink","hiddenFields","select","_select$getHiddenFiel","getHiddenFields","path","_fields","then","res","link","length","query","hash","field","includes","name","Object","keys","createElement","className","title","onRequestClose","href","target","rel"],"sources":["@quillforms/admin-components/src/share-form-modal/index.tsx"],"sourcesContent":["/**\n * WordPress Dependencies\n */\nimport { useEffect, useState } from 'react';\nimport { useSelect } from '@wordpress/data';\nimport apiFetch from '@wordpress/api-fetch';\nimport { addQueryArgs, buildQueryString } from '@wordpress/url';\nimport { Modal } from '@wordpress/components';\n\n/**\n * External Dependencies\n */\n\nimport { css } from 'emotion';\nimport classnames from 'classnames';\n\n/**\n * Internal Dependencies\n */\nimport LinkPlaceholder from './link-placeholder';\n\ninterface Props {\n\tformId: number;\n\tcloseModal: () => void;\n}\nconst ShareFormModal: React.FC< Props > = ( { formId, closeModal } ) => {\n\tconst [ isFetching, setIsFetching ] = useState( true );\n\tconst [ permalink, setPermalink ] = useState( '' );\n\tconst { hiddenFields } = useSelect( ( select ) => {\n\t\treturn {\n\t\t\thiddenFields:\n\t\t\t\tselect(\n\t\t\t\t\t'quillForms/hidden-fields-editor'\n\t\t\t\t\t//@ts-expect-error\n\t\t\t\t)?.getHiddenFields() ?? [],\n\t\t};\n\t} );\n\n\t// Invalidate resolution for entity record on unmount\n\tuseEffect( () => {\n\t\tapiFetch( {\n\t\t\tpath: addQueryArgs( `/wp/v2/quill_forms/${ formId }`, {\n\t\t\t\t_fields: [ 'link' ],\n\t\t\t} ),\n\t\t} ).then( ( res ) => {\n\t\t\tsetIsFetching( false );\n\t\t\t//@ts-expect-error\n\t\t\tsetPermalink( res.link );\n\t\t} );\n\t}, [] );\n\n\tlet link = permalink;\n\tif ( hiddenFields.length > 0 ) {\n\t\tconst query = {};\n\t\tconst hash = {};\n\t\tfor ( const field of hiddenFields ) {\n\t\t\tif (\n\t\t\t\t[\n\t\t\t\t\t'utm_source',\n\t\t\t\t\t'utm_medium',\n\t\t\t\t\t'utm_campaign',\n\t\t\t\t\t'utm_term',\n\t\t\t\t\t'utm_content',\n\t\t\t\t].includes( field.name )\n\t\t\t) {\n\t\t\t\tquery[ field.name ] = 'xxxxx';\n\t\t\t} else {\n\t\t\t\thash[ field.name ] = 'xxxxx';\n\t\t\t}\n\t\t}\n\t\tif ( Object.keys( query ).length ) {\n\t\t\tlink += '?' + buildQueryString( query );\n\t\t}\n\t\tif ( Object.keys( hash ).length ) {\n\t\t\tlink += '#' + buildQueryString( hash );\n\t\t}\n\t}\n\n\treturn (\n\t\t<Modal\n\t\t\tclassName={ classnames(\n\t\t\t\tcss`\n\t\t\t\t\tborder: none !important;\n\t\t\t\t\tmin-width: 420px !important;\n\t\t\t\t\tmax-width: 470px !important;\n\t\t\t\t\tborder-radius: 10px;\n\t\t\t\t\tz-index: 1111111;\n\t\t\t\t`\n\t\t\t) }\n\t\t\ttitle=\"Share form\"\n\t\t\tonRequestClose={ closeModal }\n\t\t>\n\t\t\t<div\n\t\t\t\tclassName={ classnames(\n\t\t\t\t\t'admin-components-share-form-modal__link',\n\t\t\t\t\tcss`\n\t\t\t\t\t\tdisplay: flex;\n\t\t\t\t\t\tflex-direction: column;\n\t\t\t\t\t\tmargin-top: 10px;\n\t\t\t\t\t`\n\t\t\t\t) }\n\t\t\t>\n\t\t\t\t<div\n\t\t\t\t\tclassName={ css`\n\t\t\t\t\t\tmargin-bottom: 6px;\n\t\t\t\t\t\tfont-weight: bold;\n\t\t\t\t\t` }\n\t\t\t\t>\n\t\t\t\t\tLink\n\t\t\t\t</div>\n\t\t\t\t{ isFetching ? (\n\t\t\t\t\t<LinkPlaceholder />\n\t\t\t\t) : (\n\t\t\t\t\t<div\n\t\t\t\t\t\tclassName={ css`\n\t\t\t\t\t\t\tborder-radius: 5px;\n\t\t\t\t\t\t\tpadding: 8px;\n\t\t\t\t\t\t\tbackground: #eeeeee;\n\t\t\t\t\t\t` }\n\t\t\t\t\t>\n\t\t\t\t\t\t<a href={ link } target=\"_blank\" rel=\"noreferrer\">\n\t\t\t\t\t\t\t{ link }\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</div>\n\t\t\t\t) }\n\t\t\t</div>\n\t\t\t<div\n\t\t\t\tclassName={ classnames(\n\t\t\t\t\t'admin-components-share-form-modal__shortcode',\n\t\t\t\t\tcss`\n\t\t\t\t\t\tdisplay: flex;\n\t\t\t\t\t\tflex-direction: column;\n\t\t\t\t\t\tmargin-top: 10px;\n\t\t\t\t\t`\n\t\t\t\t) }\n\t\t\t>\n\t\t\t\t<div\n\t\t\t\t\tclassName={ css`\n\t\t\t\t\t\tmargin-bottom: 6px;\n\t\t\t\t\t\tfont-weight: bold;\n\t\t\t\t\t` }\n\t\t\t\t>\n\t\t\t\t\tShortcode\n\t\t\t\t</div>\n\t\t\t\t{ isFetching ? (\n\t\t\t\t\t<LinkPlaceholder />\n\t\t\t\t) : (\n\t\t\t\t\t<div\n\t\t\t\t\t\tclassName={ css`\n\t\t\t\t\t\t\tborder-radius: 5px;\n\t\t\t\t\t\t\tpadding: 8px;\n\t\t\t\t\t\t\tbackground: #eeeeee;\n\t\t\t\t\t\t` }\n\t\t\t\t\t>\n\t\t\t\t\t\t{ `[quillforms id=\"${ formId }\" width=\"100%\"]` }\n\t\t\t\t\t</div>\n\t\t\t\t) }\n\t\t\t</div>\n\t\t\t<div\n\t\t\t\tclassName={ classnames(\n\t\t\t\t\t'admin-components-share-form-modal__embed',\n\t\t\t\t\tcss`\n\t\t\t\t\t\tdisplay: flex;\n\t\t\t\t\t\tflex-direction: column;\n\t\t\t\t\t\tmargin-top: 10px;\n\t\t\t\t\t`\n\t\t\t\t) }\n\t\t\t>\n\t\t\t\t<div\n\t\t\t\t\tclassName={ css`\n\t\t\t\t\t\tmargin-bottom: 6px;\n\t\t\t\t\t\tfont-weight: bold;\n\t\t\t\t\t` }\n\t\t\t\t>\n\t\t\t\t\tEmbed\n\t\t\t\t</div>\n\t\t\t\t{ isFetching ? (\n\t\t\t\t\t<LinkPlaceholder />\n\t\t\t\t) : (\n\t\t\t\t\t<div\n\t\t\t\t\t\tclassName={ css`\n\t\t\t\t\t\t\tborder-radius: 5px;\n\t\t\t\t\t\t\tpadding: 8px;\n\t\t\t\t\t\t\tbackground: #eeeeee;\n\t\t\t\t\t\t` }\n\t\t\t\t\t>\n\t\t\t\t\t\t{ `<iframe src=\"${ link }\" width=\"100%\" height=\"600\" style=\"border:0;\"></iframe>` }\n\t\t\t\t\t</div>\n\t\t\t\t) }\n\t\t\t</div>\n\t\t</Modal>\n\t);\n};\n\nexport default ShareFormModal;\n"],"mappings":"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","ignoreList":[]}