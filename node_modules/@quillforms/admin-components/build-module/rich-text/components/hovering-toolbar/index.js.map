{"version":3,"names":["useRef","useEffect","forwardRef","createPortal","cx","css","useSlate","useFocused","Editor","Range","Link","FormatButton","FormatBoldIcon","FormatItalicIcon","Menu","className","props","ref","createElement","HoveringToolbar","toggleFormat","isFormatActive","formattingControls","editor","inFocus","el","current","selection","isCollapsed","string","removeAttribute","domSelection","window","getSelection","domRange","getRangeAt","rect","getBoundingClientRect","style","opacity","top","pageYOffset","offsetHeight","left","pageXOffset","offsetWidth","width","includes","format","document","body"],"sources":["@quillforms/admin-components/src/rich-text/components/hovering-toolbar/index.tsx"],"sourcesContent":["/**\n * WordPress Dependencies\n */\nimport { useRef, useEffect, forwardRef } from 'react';\nimport { createPortal } from 'react-dom';\n\n/**\n * External Dependencies\n */\nimport { cx, css } from 'emotion';\nimport { useSlate, useFocused } from 'slate-react';\nimport { Editor, Range } from 'slate';\n\n/**\n * Internal Dependencies\n */\nimport Link from '../link';\nimport FormatButton from '../format-button';\nimport FormatBoldIcon from './bold-icon';\nimport FormatItalicIcon from './italic-icon';\ninterface Props {\n\tclassName: string;\n\t[ key: string ]: unknown;\n}\n\nconst Menu = forwardRef< HTMLDivElement, React.PropsWithChildren< Props > >(\n\t( { className, ...props }, ref ) => (\n\t\t<div\n\t\t\t{ ...props }\n\t\t\tref={ ref }\n\t\t\tclassName={ cx(\n\t\t\t\tclassName,\n\t\t\t\tcss`\n\t\t\t\t\t& > * {\n\t\t\t\t\t\tdisplay: inline-block;\n\t\t\t\t\t}\n\t\t\t\t\t& > * + * {\n\t\t\t\t\t\tmargin-left: 15px;\n\t\t\t\t\t}\n\t\t\t\t`\n\t\t\t) }\n\t\t/>\n\t)\n);\n\nconst HoveringToolbar = ( {\n\ttoggleFormat,\n\tisFormatActive,\n\tformattingControls,\n} ) => {\n\tconst ref = useRef< HTMLDivElement | null >( null );\n\tconst editor = useSlate();\n\tconst inFocus = useFocused();\n\tuseEffect( () => {\n\t\tconst el = ref.current;\n\t\tconst { selection } = editor;\n\n\t\tif ( ! el ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (\n\t\t\t! selection ||\n\t\t\t! inFocus ||\n\t\t\tRange.isCollapsed( selection ) ||\n\t\t\tEditor.string( editor, selection ) === ''\n\t\t) {\n\t\t\tel.removeAttribute( 'style' );\n\t\t\treturn;\n\t\t}\n\n\t\tconst domSelection = window.getSelection();\n\t\tconst domRange = domSelection?.getRangeAt( 0 );\n\t\tconst rect = domRange?.getBoundingClientRect();\n\t\tel.style.opacity = '1';\n\t\tif ( rect ) {\n\t\t\tel.style.top = `${\n\t\t\t\trect.top + window.pageYOffset - el.offsetHeight\n\t\t\t}px`;\n\t\t\tel.style.left = `${\n\t\t\t\trect.left +\n\t\t\t\twindow.pageXOffset -\n\t\t\t\tel.offsetWidth / 2 +\n\t\t\t\trect.width / 2\n\t\t\t}px`;\n\t\t}\n\t} );\n\n\treturn createPortal(\n\t\t<Menu\n\t\t\tref={ ref }\n\t\t\tclassName={ css`\n\t\t\t\tpadding: 8px 7px 6px;\n\t\t\t\tposition: absolute;\n\t\t\t\tz-index: 1;\n\t\t\t\ttop: -10000px;\n\t\t\t\tleft: -10000px;\n\t\t\t\tmargin-top: -6px;\n\t\t\t\topacity: 0;\n\t\t\t\tbackground-color: #222;\n\t\t\t\tborder-radius: 4px;\n\t\t\t\ttransition: opacity 0.75s;\n\n\t\t\t\tsvg {\n\t\t\t\t\twidth: 20px;\n\t\t\t\t}\n\t\t\t` }\n\t\t>\n\t\t\t{ !! formattingControls && formattingControls.includes( 'bold' ) && (\n\t\t\t\t<FormatButton\n\t\t\t\t\tformat=\"bold\"\n\t\t\t\t\ttoggleFormat={ () => toggleFormat( 'bold' ) }\n\t\t\t\t\tisFormatActive={ () => isFormatActive( 'bold' ) }\n\t\t\t\t>\n\t\t\t\t\t<FormatBoldIcon />\n\t\t\t\t</FormatButton>\n\t\t\t) }\n\t\t\t{ !! formattingControls &&\n\t\t\t\tformattingControls.includes( 'italic' ) && (\n\t\t\t\t\t<FormatButton\n\t\t\t\t\t\tformat=\"italic\"\n\t\t\t\t\t\ttoggleFormat={ () => toggleFormat( 'italic' ) }\n\t\t\t\t\t\tisFormatActive={ () => isFormatActive( 'italic' ) }\n\t\t\t\t\t>\n\t\t\t\t\t\t<FormatItalicIcon />\n\t\t\t\t\t</FormatButton>\n\t\t\t\t) }\n\t\t\t{ !! formattingControls &&\n\t\t\t\tformattingControls.includes( 'link' ) && (\n\t\t\t\t\t<Link editor={ editor } />\n\t\t\t\t) }\n\t\t</Menu>,\n\t\tdocument.body\n\t);\n};\nexport default HoveringToolbar;\n"],"mappings":"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","ignoreList":[]}