{"version":3,"names":["Fragment","useCallback","useEffect","useState","useRef","Popover","Transforms","Text","Editor","Range","Slate","Editable","ReactEditor","css","Element","HoveringToolbar","MergeTagListItem","TextEditor","props","editor","placeholder","color","onChange","value","onFocus","mergeTags","allowedFormats","wrapperRef","PopoverRef","ref","target","setTarget","index","setIndex","search","setSearch","$mergeTags","filter","c","label","toLowerCase","startsWith","isFormatActive","format","match","nodes","n","mode","renderElement","createElement","toggleFormat","active","setNodes","isText","split","Leaf","attributes","children","leaf","bold","italic","insertMergeTag","mergeTag","insertNodes","type","data","modifier","text","setTimeout","move","onKeyDown","event","key","length","preventDefault","prevIndex","nextIndex","select","undefined","handleClickOutsidePortal","current","contains","document","addEventListener","removeEventListener","className","style","width","initialValue","val","selection","isCollapsed","start","edges","wordBefore","before","beforeRange","range","beforeText","string","beforeMatch","endsWith","after","afterRange","afterText","afterMatch","formattingControls","renderLeaf","$props","renderPlaceholder","opacity","height","position","zIndex","onDOMBeforeInput","inputType","map","i","onClick","focus","onMouseEnter","isSelected"],"sources":["@quillforms/admin-components/src/rich-text/components/editor/index.tsx"],"sourcesContent":["/* eslint-disable no-nested-ternary */\n/**\n * WordPress Dependencies\n */\nimport { Fragment, useCallback, useEffect, useState, useRef } from 'react';\nimport { Popover } from '@wordpress/components';\n\n/**\n * External Dependencies\n */\nimport { Transforms, Text, Editor, Range, Node as SlateNode } from 'slate';\nimport { Slate, Editable, ReactEditor, RenderElementProps } from 'slate-react';\nimport { HistoryEditor } from 'slate-history';\nimport { css } from 'emotion';\n\n/**\n * Internal Dependencies\n */\nimport Element from '../element';\nimport HoveringToolbar from '../hovering-toolbar';\nimport MergeTagListItem from '../merge-tag-list-item';\nimport type {\n\tMergeTags,\n\tMergeTagsSections,\n\tMergeTag,\n\tallowedFormats,\n} from '../../types';\ninterface Props {\n\teditor: ReactEditor & HistoryEditor;\n\tplaceholder?: string;\n\tcolor?: string;\n\tvalue: SlateNode[];\n\tonChange: (value: SlateNode[]) => void;\n\tonFocus: React.FocusEventHandler;\n\tmergeTags?: MergeTags;\n\tmergeTagsSections?: MergeTagsSections;\n\tallowedFormats?: allowedFormats;\n}\nconst TextEditor: React.FC<Props> = (props) => {\n\tconst {\n\t\teditor,\n\t\tplaceholder,\n\t\tcolor,\n\t\tonChange,\n\t\tvalue,\n\t\tonFocus,\n\t\tmergeTags = [],\n\t\t// mergeTagsSections = [\n\t\t// \t{ key: 'field', label: 'Fields' },\n\t\t// \t{ key: 'variable', label: 'Variables' },\n\t\t// \t{ key: 'hidden_field', label: 'Hidden Fields' },\n\t\t// ],\n\t\tallowedFormats = [],\n\t} = props;\n\n\tconst wrapperRef = useRef<HTMLDivElement>(null);\n\tconst PopoverRef = useRef(null);\n\tconst ref = useRef<HTMLDivElement>(null);\n\tconst [target, setTarget] = useState<Range | undefined>();\n\tconst [index, setIndex] = useState(0);\n\tconst [search, setSearch] = useState('');\n\n\tconst $mergeTags = mergeTags.filter((c) => {\n\t\tif (search) {\n\t\t\treturn c.label\n\t\t\t\t?.toLowerCase()\n\t\t\t\t.startsWith(search ? search.toLowerCase() : '');\n\t\t}\n\t\treturn true;\n\t});\n\n\tconst isFormatActive = (format) => {\n\t\tconst [match] = Editor.nodes(editor, {\n\t\t\tmatch: (n) => n[format] === true,\n\t\t\tmode: 'all',\n\t\t});\n\t\treturn !!match;\n\t};\n\n\tconst renderElement = useCallback(props => {\n\t\treturn <Element {...props} editor={editor} mergeTags={mergeTags} />;\n\t}, [mergeTags, value]);\n\n\n\tconst toggleFormat = (editor: Editor, format) => {\n\t\tconst active = isFormatActive(format);\n\t\tTransforms.setNodes(\n\t\t\teditor,\n\t\t\t{ [format]: active ? null : true },\n\t\t\t{ match: Text.isText, split: true }\n\t\t);\n\t};\n\n\tconst Leaf = ({ attributes, children, leaf }) => {\n\t\tif (leaf.bold) {\n\t\t\tchildren = <strong>{children}</strong>;\n\t\t}\n\n\t\tif (leaf.italic) {\n\t\t\tchildren = <em>{children}</em>;\n\t\t}\n\n\t\treturn <span {...attributes}>{children}</span>;\n\t};\n\n\t// Insert Variable\n\tconst insertMergeTag = (mergeTag: MergeTag) => {\n\t\tTransforms.insertNodes(editor, {\n\t\t\ttype: 'mergeTag',\n\t\t\tdata: {\n\t\t\t\ttype: mergeTag.type,\n\t\t\t\tmodifier: mergeTag.modifier,\n\t\t\t},\n\t\t\tchildren: [{ text: '' }],\n\t\t});\n\t\tsetTimeout(() => {\n\t\t\tTransforms.move(editor);\n\t\t}, 0);\n\t};\n\n\tconst onKeyDown = useCallback(\n\t\t(event) => {\n\t\t\tif (event.key === 'Enter' && allowedFormats?.length === 0) {\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\t\t\tif (target) {\n\t\t\t\tswitch (event.key) {\n\t\t\t\t\tcase 'ArrowDown':\n\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\tconst prevIndex =\n\t\t\t\t\t\t\tindex >= $mergeTags.length - 1 ? 0 : index + 1;\n\t\t\t\t\t\tsetIndex(prevIndex);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'ArrowUp':\n\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\tconst nextIndex =\n\t\t\t\t\t\t\tindex <= 0 ? $mergeTags.length - 1 : index - 1;\n\t\t\t\t\t\tsetIndex(nextIndex);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'Tab':\n\t\t\t\t\tcase 'Enter':\n\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\tTransforms.select(editor, target);\n\t\t\t\t\t\tinsertMergeTag($mergeTags[index]);\n\t\t\t\t\t\tsetTarget(undefined);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'Escape':\n\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\tsetTarget(undefined);\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t[index, search, target]\n\t);\n\n\t// useEffect( () => {\n\t// \tif ( target && $mergeTags.length > 0 ) {\n\t// \t\tconst el: HTMLDivElement | null = ref.current;\n\t// \t\tconst domRange = ReactEditor.toDOMRange( editor, target );\n\t// \t\tconst rect = domRange.getBoundingClientRect();\n\t// \t\tif ( el ) {\n\t// \t\t\tel.style.top = `${ rect.top + window.pageYOffset + 24 }px`;\n\t// \t\t\tel.style.left = `${ rect.left + window.pageXOffset }px`;\n\t// \t\t}\n\t// \t}\n\t// }, [ $mergeTags.length, editor, index, search, target ] );\n\n\tuseEffect(() => {\n\t\t/**\n\t\t * Alert if clicked on outside of element\n\t\t *\n\t\t * @param  event\n\t\t */\n\t\tfunction handleClickOutsidePortal(event: MouseEvent): void {\n\t\t\tif (\n\t\t\t\tPopoverRef.current &&\n\t\t\t\tref.current &&\n\t\t\t\t// @ts-expect-error\n\t\t\t\t!PopoverRef.current.contains(event.target as Node) &&\n\t\t\t\t!ref.current.contains(event.target as Node)\n\t\t\t) {\n\t\t\t\tsetTarget(undefined);\n\t\t\t}\n\t\t}\n\n\t\t// Bind the event listener\n\t\tdocument.addEventListener('mousedown', handleClickOutsidePortal);\n\t\treturn () => {\n\t\t\t// Unbind the event listener on clean up\n\t\t\tdocument.removeEventListener(\n\t\t\t\t'mousedown',\n\t\t\t\thandleClickOutsidePortal\n\t\t\t);\n\t\t};\n\t}, [PopoverRef]);\n\n\treturn (\n\t\t<Fragment>\n\t\t\t<div\n\t\t\t\tclassName=\"richtext__editor\"\n\t\t\t\tstyle={{ width: '100%' }}\n\t\t\t\tref={wrapperRef}\n\t\t\t>\n\t\t\t\t<Slate\n\t\t\t\t\teditor={editor}\n\t\t\t\t\tinitialValue={value}\n\t\t\t\t\tonChange={(val) => {\n\t\t\t\t\t\tonChange(val);\n\t\t\t\t\t\tconst { selection } = editor;\n\n\t\t\t\t\t\tif (selection && Range.isCollapsed(selection)) {\n\t\t\t\t\t\t\tconst [start] = Range.edges(selection);\n\t\t\t\t\t\t\tconst wordBefore = selection;\n\t\t\t\t\t\t\tconst before =\n\t\t\t\t\t\t\t\twordBefore &&\n\t\t\t\t\t\t\t\tEditor.before(editor, wordBefore);\n\t\t\t\t\t\t\tconst beforeRange =\n\t\t\t\t\t\t\t\tbefore && Editor.range(editor, before, start);\n\t\t\t\t\t\t\tconst beforeText =\n\t\t\t\t\t\t\t\tbeforeRange &&\n\t\t\t\t\t\t\t\tEditor.string(editor, beforeRange);\n\t\t\t\t\t\t\tconst beforeMatch =\n\t\t\t\t\t\t\t\tbeforeText && beforeText.endsWith('@');\n\t\t\t\t\t\t\tconst after = Editor.after(editor, start);\n\t\t\t\t\t\t\tconst afterRange = Editor.range(\n\t\t\t\t\t\t\t\teditor,\n\t\t\t\t\t\t\t\tstart,\n\t\t\t\t\t\t\t\tafter\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tconst afterText = Editor.string(\n\t\t\t\t\t\t\t\teditor,\n\t\t\t\t\t\t\t\tafterRange\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tconst afterMatch = afterText.match(/^(\\s|$)/);\n\n\t\t\t\t\t\t\tif (beforeMatch && afterMatch) {\n\t\t\t\t\t\t\t\tsetTarget(beforeRange);\n\t\t\t\t\t\t\t\tsetSearch(beforeMatch[1]);\n\t\t\t\t\t\t\t\tsetIndex(0);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tsetTarget(undefined);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t{allowedFormats?.length > 0 && (\n\t\t\t\t\t\t<HoveringToolbar\n\t\t\t\t\t\t\tformattingControls={allowedFormats}\n\t\t\t\t\t\t\ttoggleFormat={(format) =>\n\t\t\t\t\t\t\t\ttoggleFormat(editor, format)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tisFormatActive={(format) =>\n\t\t\t\t\t\t\t\tisFormatActive(format)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\t\t\t\t\t<Editable\n\t\t\t\t\t\tstyle={{ color }}\n\t\t\t\t\t\tcolor={color}\n\t\t\t\t\t\trenderLeaf={($props) => <Leaf {...$props} />}\n\t\t\t\t\t\trenderElement={renderElement}\n\t\t\t\t\t\trenderPlaceholder={({ attributes, children }) => (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t{...attributes}\n\t\t\t\t\t\t\t\t\tstyle={{ opacity: 0, height: 0, position: \"relative\", zIndex: -1 }}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{children}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div {...attributes}>\n\t\t\t\t\t\t\t\t\t{children}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\tplaceholder={placeholder}\n\t\t\t\t\t\tonFocus={onFocus}\n\t\t\t\t\t\tonKeyDown={onKeyDown}\n\t\t\t\t\t\tonDOMBeforeInput={(event: Event) => {\n\t\t\t\t\t\t\tswitch ((event as InputEvent).inputType) {\n\t\t\t\t\t\t\t\tcase 'formatBold':\n\t\t\t\t\t\t\t\t\treturn toggleFormat(editor, 'bold');\n\t\t\t\t\t\t\t\tcase 'formatItalic':\n\t\t\t\t\t\t\t\t\treturn toggleFormat(editor, 'italic');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}}\n\t\t\t\t\t/>\n\t\t\t\t\t{target && $mergeTags.length > 0 && (\n\t\t\t\t\t\t<Popover\n\t\t\t\t\t\t\tref={PopoverRef}\n\t\t\t\t\t\t\tclassName={css`\n\t\t\t\t\t\t\t\tz-index: 1111111111111111111;\n\t\t\t\t\t\t\t\t.components-popover__content {\n\t\t\t\t\t\t\t\t\tpadding: 3px;\n\t\t\t\t\t\t\t\t\tborder: none;\n\t\t\t\t\t\t\t\t\tborder-radius: 4px;\n\t\t\t\t\t\t\t\t\tbox-shadow: 0 1px 5px rgba( 0, 0, 0, 0.2 );\n\t\t\t\t\t\t\t\t\tz-index: 111111111111111111;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t` }\n\t\t\t\t\t\t\tonKeyDown={onKeyDown}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclassName={css`\n\t\t\t\t\t\t\t\t\tpadding: 5px 25px;\n\t\t\t\t\t\t\t\t\tfont-weight: bold;\n\t\t\t\t\t\t\t\t` }\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tRecall Information from...\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclassName=\"rich-text-merge-tag-list\"\n\t\t\t\t\t\t\t\tref={ref}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{$mergeTags.map((mergeTag, i) => (\n\t\t\t\t\t\t\t\t\t<MergeTagListItem\n\t\t\t\t\t\t\t\t\t\tkey={`merge-tag-${i}`}\n\t\t\t\t\t\t\t\t\t\tmergeTag={mergeTag}\n\t\t\t\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\t\t\t\tTransforms.select(editor, target);\n\t\t\t\t\t\t\t\t\t\t\tinsertMergeTag(mergeTag);\n\t\t\t\t\t\t\t\t\t\t\tReactEditor.focus(editor);\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\tonMouseEnter={() => setIndex(i)}\n\t\t\t\t\t\t\t\t\t\tisSelected={index === i}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</Popover>\n\t\t\t\t\t)}\n\t\t\t\t</Slate>\n\t\t\t</div>\n\t\t</Fragment>\n\t);\n};\n\n/**\n * Export.\n */\nexport default TextEditor;\n"],"mappings":"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","ignoreList":[]}