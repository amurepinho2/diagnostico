{"version":3,"names":["_config","_interopRequireDefault","require","_data","_lodash","_setBlockAdminSettings","_setBlockRendererSettings","getDefaultBlockSupports","editable","required","attachment","description","defaultValue","placeholder","logic","logicConditions","innerBlocks","numeric","choices","payments","points","correctAnswers","exports","registerBlockType","name","settings","console","error","isWPEnv","ConfigAPI","window","quillformsSaasManagerAdmin","plan","select","getBlockType","supports","attributes","isPlainObject","type","default","nextBtnLabel","classnames","properties","url","theme","themeId","randomize","label","customHTML","layout","attachmentFocalPoint","x","y","attachmentFancyBorderRadius","attachmentBorderRadius","attachmentMaxWidth","dispatch","addBlockTypes","pick","setBlockRendererSettings","setBlockAdminSettings"],"sources":["@quillforms/blocks/src/api/registration.ts"],"sourcesContent":["/* eslint-disable no-console */\r\n/**\r\n * QuillForms Dependencies\r\n */\r\nimport ConfigAPI from '@quillforms/config';\r\n\r\n/**\r\n * WordPress Dependencies\r\n */\r\nimport { select, dispatch } from '@wordpress/data';\r\n\r\n/**\r\n * External Dependencies\r\n */\r\nimport { pick, isPlainObject } from 'lodash';\r\n\r\n/**\r\n * Internal Dependencies\r\n */\r\nimport { setBlockAdminSettings } from './set-block-admin-settings';\r\nimport { setBlockRendererSettings } from './set-block-renderer-settings';\r\nimport type { BlockTypeSettings, BlockSupportedFeatures } from '../types';\r\n\r\nexport const getDefaultBlockSupports = (): BlockSupportedFeatures => {\r\n\r\n\treturn {\r\n\t\teditable: true,\r\n\t\trequired: true,\r\n\t\tattachment: true,\r\n\t\tdescription: true,\r\n\t\tdefaultValue: false,\r\n\t\tplaceholder: false,\r\n\t\tlogic: true,\r\n\t\tlogicConditions: true,\r\n\t\tinnerBlocks: false,\r\n\t\tnumeric: false,\r\n\t\tchoices: false,\r\n\t\tpayments: false,\r\n\t\tpoints: false,\r\n\t\tcorrectAnswers: false\r\n\t};\r\n};\r\n\r\n/**\r\n * Registers a new block provided a unique name and an object defining its\r\n * behavior. Once registered, the block is made available as an option to any\r\n * editor interface where blocks are implemented.\r\n *\r\n * @param  name     Block name.\r\n * @param  settings Block settings.\r\n *\r\n * @return The block settings, if it has been successfully registered;\r\n * otherwise `undefined`.\r\n */\r\nexport const registerBlockType = (\r\n\tname: string,\r\n\tsettings: BlockTypeSettings\r\n): BlockTypeSettings | undefined => {\r\n\r\n\tif ( typeof name !== 'string' ) {\r\n\t\tconsole.error( 'Block names must be strings.' );\r\n\t\treturn;\r\n\t}\r\n\r\n\tconst isWPEnv = ConfigAPI.isWPEnv();\r\n\tif( name === 'file' && !isWPEnv && window?.quillformsSaasManagerAdmin?.plan?.plan === 'free' ) {\r\n\t\treturn;\r\n\t}\r\n\r\n\tif ( select( 'quillForms/blocks' ).getBlockType( name ) ) {\r\n\t\tconsole.error( 'Block \"' + name + '\" is already registered.' );\r\n\t\treturn;\r\n\t}\r\n\r\n\tsettings.supports = {\r\n\t\t...getDefaultBlockSupports(),\r\n\t\t...settings.supports,\r\n\t};\r\n\r\n\tlet { attributes } = settings;\r\n\tconst { supports } = settings;\r\n\r\n\tif ( ! attributes || ! isPlainObject( attributes ) ) {\r\n\t\tattributes = {};\r\n\t}\r\n\tif ( supports.required ) {\r\n\t\tattributes.required = {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tdefault: false,\r\n\t\t};\r\n\t}\r\n\r\n\tattributes.nextBtnLabel = {\r\n\t\ttype: [ 'string', 'boolean' ],\r\n\t\tdefault: false,\r\n\t};\r\n\r\n\tattributes.classnames = {\r\n\t\ttype: 'string',\r\n\t\tdefault: '',\r\n\t};\r\n\r\n\tif ( supports.placeholder ) {\r\n\t\tattributes.placeholder = {\r\n\t\t\ttype: [ 'string', 'boolean' ],\r\n\t\t\tdefault: false,\r\n\t\t};\r\n\t}\r\n\tif ( supports.attachment ) {\r\n\t\tattributes.attachment = {\r\n\t\t\ttype: 'object',\r\n\t\t\tproperties: {\r\n\t\t\t\turl: {\r\n\t\t\t\t\ttype: 'string',\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t};\r\n\t}\r\n\r\n\tif ( supports.defaultValue ) {\r\n\t\tattributes.defaultValue = {\r\n\t\t\ttype: 'string',\r\n\t\t\tdefault: '',\r\n\t\t};\r\n\t}\r\n\r\n\tif ( supports.description ) {\r\n\t\tattributes.description = {\r\n\t\t\ttype: 'string',\r\n\t\t\tdefault: '',\r\n\t\t};\r\n\t}\r\n\tif ( supports.theme ) {\r\n\t\tattributes.themeId = {\r\n\t\t\ttype: 'number',\r\n\t\t};\r\n\t}\r\n\r\n\tif ( name === 'dropdown' ||\r\n\t\t name === 'multiple-choice' ||\r\n\t\t name === 'picture-choice' \r\n\t) {\r\n\t\tattributes.randomize = {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tdefault: false\r\n\t\t}\r\n\t}\r\n\tattributes.label = {\r\n\t\ttype: 'string',\r\n\t\tdefault: '',\r\n\t};\r\n\tattributes.customHTML = {\r\n\t\ttype: 'string',\r\n\t\tdefault: '',\r\n\t};\r\n\tattributes.layout = {\r\n\t\ttype: 'string',\r\n\t\tdefault: 'stack',\r\n\t};\r\n\tattributes.attachmentFocalPoint = {\r\n\t\ttype: 'object',\r\n\t\tdefault: {\r\n\t\t\tx: 0.5,\r\n\t\t\ty: 0.5,\r\n\t\t},\r\n\t};\r\n\r\n\tattributes.attachmentFancyBorderRadius = {\r\n\t\ttype: 'boolean',\r\n\t\tdefault: false,\r\n\t};\r\n\r\n\tattributes.attachmentBorderRadius = {\r\n\t\ttype: 'boolean',\r\n\t\tdefault: '0px',\r\n\t};\r\n\r\n\tattributes.attachmentMaxWidth = {\r\n\t\ttype: 'string',\r\n\t\tdefault: 'none',\r\n\t};\r\n\r\n\tsettings.attributes = attributes;\r\n\r\n\tdispatch( 'quillForms/blocks' ).addBlockTypes( {\r\n\t\tname,\r\n\t\t...pick( settings, [ 'attributes', 'supports', 'logicalOperators' ] ),\r\n\t} );\r\n\tsetBlockRendererSettings( name, settings );\r\n\tsetBlockAdminSettings( name, settings );\r\n\treturn settings;\r\n};\r\n\r\n/**\r\n * Returns a registered block type.\r\n *\r\n * @param {string} name Block name.\r\n *\r\n * @return {?BlockTypeSettingss} Block type.\r\n */\r\nexport function getBlockType( name: string ): BlockTypeSettings | undefined {\r\n\treturn select( 'quillForms/blocks' ).getBlockType( name );\r\n}\r\n"],"mappings":"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","ignoreList":[]}