{"version":3,"names":["useMessages","useCorrectIncorrectQuiz","useEffect","useState","set","size","ChoicesWrapper","multipleChoiceTimer","MultipleChoiceOutput","props","id","attributes","setIsValid","setIsAnswered","showNextBtn","setValidationErr","val","setVal","next","isAnswerLocked","isActive","isAnimating","showErrMsg","isPreview","isReviewing","setIsAnswerCorrect","multiple","required","min","max","messages","correctIncorrectQuiz","choiceClicked","setChoiceClicked","checkfieldValidation","$val","length","enabled","showAnswersDuringQuiz","isCorrect","every","answer","questions","correctAnswers","includes","clearTimeout","setTimeout","createElement","className"],"sources":["@quillforms/blocklib-multiple-choice-block/src/renderer/display.js"],"sourcesContent":["/**\r\n * QuillForms Depndencies\r\n */\r\nimport { useMessages, useCorrectIncorrectQuiz } from '@quillforms/renderer-core';\r\n\r\n/**\r\n * WordPress Dependencies\r\n */\r\nimport { useEffect, useState } from 'react';\r\n\r\n/**\r\n * External Dependencies\r\n */\r\nimport { set, size } from 'lodash';\r\n\r\n/**\r\n * Internal Dependencies\r\n */\r\nimport ChoicesWrapper from './choices-wrapper';\r\n\r\nlet multipleChoiceTimer;\r\nconst MultipleChoiceOutput = (props) => {\r\n\tconst {\r\n\t\tid,\r\n\t\tattributes,\r\n\t\tsetIsValid,\r\n\t\tsetIsAnswered,\r\n\t\tshowNextBtn,\r\n\t\tsetValidationErr,\r\n\t\tval,\r\n\t\tsetVal,\r\n\t\tnext,\r\n\t\tisAnswerLocked,\r\n\t\tisActive,\r\n\t\tisAnimating,\r\n\t\tshowErrMsg,\r\n\t\tisPreview,\r\n\t\tisReviewing,\r\n\t\tsetIsAnswerCorrect\r\n\t} = props;\r\n\tconst { multiple, required, min, max } = attributes;\r\n\tconst messages = useMessages();\r\n\tconst correctIncorrectQuiz = useCorrectIncorrectQuiz();\r\n\tconst [choiceClicked, setChoiceClicked] = useState(null);\r\n\tconst checkfieldValidation = ($val) => {\r\n\t\tif (required === true && (!$val || $val.length === 0)) {\r\n\t\t\tsetIsValid(false);\r\n\t\t\tsetValidationErr(messages['label.errorAlert.required']);\r\n\t\t} else {\r\n\t\t\tif (size($val) > 0 && correctIncorrectQuiz?.enabled && correctIncorrectQuiz?.showAnswersDuringQuiz) {\r\n\t\t\t\t// $val is array of selected choices\r\n\t\t\t\t// const isCorrect = correctIncorrectQuiz?.questions?.[id]?.correctAnswers?.includes($val);\r\n\t\t\t\t// if each value from $val includes any answer from those in the correctAnswers array, then it is correct, not the opposite.\r\n\r\n\t\t\t\tconst isCorrect = $val.every((answer) => correctIncorrectQuiz?.questions?.[id]?.correctAnswers?.includes(answer));\r\n\t\t\t\t// const isCorrect = correctIncorrectQuiz?.questions?.[id]?.correctAnswers?.every((answer) => $val.includes(answer));\r\n\t\t\t\tsetIsAnswerCorrect(isCorrect);\r\n\t\t\t}\r\n\t\t\tif (multiple && min && size($val) < min) {\r\n\t\t\t\tsetIsValid(false);\r\n\t\t\t\tsetValidationErr(messages['label.errorAlert.minChoices']);\r\n\t\t\t}\r\n\t\t\telse if (multiple && max && size($val) > max) {\r\n\t\t\t\tsetIsValid(false);\r\n\t\t\t\tsetValidationErr(messages['label.errorAlert.maxChoices']);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tsetIsValid(true);\r\n\t\t\t\tsetValidationErr(null);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tuseEffect(() => {\r\n\t\treturn () => clearTimeout(multipleChoiceTimer);\r\n\t}, []);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!isActive) {\r\n\t\t\tclearTimeout(multipleChoiceTimer);\r\n\t\t}\r\n\t\tif (!isActive && !isAnimating) {\r\n\t\t\tsetChoiceClicked(null);\r\n\t\t}\r\n\t}, [isActive, isAnimating]);\r\n\r\n\tuseEffect(() => {\r\n\t\tclearTimeout(multipleChoiceTimer);\r\n\t\tif (choiceClicked && val?.length > 0 && !multiple) {\r\n\t\t\tmultipleChoiceTimer = setTimeout(() => {\r\n\t\t\t\tnext();\r\n\t\t\t}, 600);\r\n\t\t}\r\n\t}, [choiceClicked]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (isPreview || !isReviewing) checkfieldValidation(val);\r\n\t}, [attributes, correctIncorrectQuiz]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (val?.length > 0) {\r\n\t\t\tsetIsAnswered(true);\r\n\t\t} else {\r\n\t\t\tsetIsAnswered(false);\r\n\t\t}\r\n\t\tif (multiple) {\r\n\t\t\tif (val?.length > 0) {\r\n\t\t\t\tshowNextBtn(true);\r\n\t\t\t}\r\n\t\t}\r\n\t}, [val, attributes]);\r\n\r\n\treturn (\r\n\t\t<div className=\"qf-multiple-choice-block-renderer\">\r\n\t\t\t<ChoicesWrapper\r\n\t\t\t\tattributes={attributes}\r\n\t\t\t\tid={id}\r\n\t\t\t\tval={val}\r\n\t\t\t\tisActive={isActive}\r\n\t\t\t\tisAnswerLocked={isAnswerLocked}\r\n\t\t\t\tcorrectIncorrectQuiz={correctIncorrectQuiz}\r\n\t\t\t\tcheckfieldValidation={checkfieldValidation}\r\n\t\t\t\tsetVal={setVal}\r\n\t\t\t\tsetChoiceClicked={(val) => {\r\n\t\t\t\t\tshowErrMsg(false);\r\n\t\t\t\t\tsetChoiceClicked(val);\r\n\t\t\t\t}}\r\n\t\t\t/>\r\n\t\t</div>\r\n\t);\r\n};\r\nexport default MultipleChoiceOutput;\r\n"],"mappings":"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","ignoreList":[]}