{"version":3,"names":["_config","_interopRequireDefault","require","_hooks","_lodash","paymentGatewayModules","registerPaymentGatewayModule","slug","module","isWPEnv","configApi","includes","window","quillformsSaasManagerAdmin","plan","applyFilters","console","error","name","icon","description","settings","isFunction","methods","_method","Object","values","exports","getPaymentGatewayModules","getPaymentGatewayModule"],"sources":["@quillforms/payment-gateways/src/api/index.ts"],"sourcesContent":["/**\r\n * Quill Forms Dependencies\r\n */\r\nimport configApi from '@quillforms/config';\r\n/**\r\n * WordPress Dependencies\r\n */\r\nimport { applyFilters } from '@wordpress/hooks';\r\n\r\n/**\r\n * External Dependencies\r\n */\r\nimport { isFunction } from 'lodash';\r\n\r\n/**\r\n * Internal Modules\r\n */\r\nimport type { PaymentGatewayModules, PaymentGatewayModule } from '../types';\r\n\r\nlet paymentGatewayModules = {};\r\n\r\n/**\r\n * Register PaymentGateway Module\r\n *\r\n * @param {string}               slug     The module slug\r\n * @param {PaymentGatewayModule} module The module properties.\r\n *\r\n */\r\nexport const registerPaymentGatewayModule = (\r\n\tslug: string,\r\n\tmodule: PaymentGatewayModule\r\n) => {\r\n\r\n\tconst isWPEnv = configApi.isWPEnv();\r\n\r\n\tif (isWPEnv || (!isWPEnv && !['free', 'basic_yearly', 'basic_monthly'].includes(window?.quillformsSaasManagerAdmin?.plan?.plan))) {\r\n\t\tmodule = applyFilters(\r\n\t\t\t'QuillForms.PaymentGateways.PaymentGatewayModule',\r\n\t\t\tmodule,\r\n\t\t\tslug\r\n\t\t) as PaymentGatewayModule;\r\n\t}\r\n\r\n\tif (paymentGatewayModules[slug]) {\r\n\t\tconsole.error(\r\n\t\t\t`This payment gateway ${slug} is already registered!`\r\n\t\t);\r\n\t\treturn;\r\n\t}\r\n\r\n\tif (!module.name) {\r\n\t\tconsole.error(`The 'name' property is mandatory!`);\r\n\t\treturn;\r\n\t}\r\n\r\n\tif (typeof module.name !== 'string') {\r\n\t\tconsole.error(`The 'name' property must be a string!`);\r\n\t\treturn;\r\n\t}\r\n\r\n\tif (!module.icon) {\r\n\t\tconsole.error(`The 'icon' property is mandatory!`);\r\n\t\treturn;\r\n\t}\r\n\r\n\tif (!module.description) {\r\n\t\tconsole.error(`The 'description' property is mandatory!`);\r\n\t\treturn;\r\n\t}\r\n\r\n\tif (module.settings && !isFunction(module.settings)) {\r\n\t\tconsole.error('The \"settings\" property must be a valid function!');\r\n\t\treturn;\r\n\t}\r\n\r\n\tif (!module.methods) {\r\n\t\tconsole.error(`The 'methods' property is mandatory!`);\r\n\t\treturn;\r\n\t}\r\n\r\n\tfor (const _method of Object.values(module.methods)) {\r\n\t\t// TODO: method props check.\r\n\t}\r\n\r\n\tpaymentGatewayModules[slug] = module;\r\n};\r\n\r\nexport const getPaymentGatewayModules = (): PaymentGatewayModules => {\r\n\treturn paymentGatewayModules;\r\n};\r\n\r\nexport const getPaymentGatewayModule = (slug: string) => {\r\n\treturn paymentGatewayModules[slug];\r\n};\r\n"],"mappings":";;;;;;;AAGA,IAAAA,OAAA,GAAAC,sBAAA,CAAAC,OAAA;AAIA,IAAAC,MAAA,GAAAD,OAAA;AAKA,IAAAE,OAAA,GAAAF,OAAA;AAZA;AACA;AACA;;AAEA;AACA;AACA;;AAGA;AACA;AACA;;AAQA,IAAIG,qBAAqB,GAAG,CAAC,CAAC;;AAE9B;AACA;AACA;AACA;AACA;AACA;AACA;AACO,MAAMC,4BAA4B,GAAGA,CAC3CC,IAAY,EACZC,MAA4B,KACxB;EAEJ,MAAMC,OAAO,GAAGC,eAAS,CAACD,OAAO,CAAC,CAAC;EAEnC,IAAIA,OAAO,IAAK,CAACA,OAAO,IAAI,CAAC,CAAC,MAAM,EAAE,cAAc,EAAE,eAAe,CAAC,CAACE,QAAQ,CAACC,MAAM,EAAEC,0BAA0B,EAAEC,IAAI,EAAEA,IAAI,CAAE,EAAE;IACjIN,MAAM,GAAG,IAAAO,mBAAY,EACpB,iDAAiD,EACjDP,MAAM,EACND,IACD,CAAyB;EAC1B;EAEA,IAAIF,qBAAqB,CAACE,IAAI,CAAC,EAAE;IAChCS,OAAO,CAACC,KAAK,CACX,wBAAuBV,IAAK,yBAC9B,CAAC;IACD;EACD;EAEA,IAAI,CAACC,MAAM,CAACU,IAAI,EAAE;IACjBF,OAAO,CAACC,KAAK,CAAE,mCAAkC,CAAC;IAClD;EACD;EAEA,IAAI,OAAOT,MAAM,CAACU,IAAI,KAAK,QAAQ,EAAE;IACpCF,OAAO,CAACC,KAAK,CAAE,uCAAsC,CAAC;IACtD;EACD;EAEA,IAAI,CAACT,MAAM,CAACW,IAAI,EAAE;IACjBH,OAAO,CAACC,KAAK,CAAE,mCAAkC,CAAC;IAClD;EACD;EAEA,IAAI,CAACT,MAAM,CAACY,WAAW,EAAE;IACxBJ,OAAO,CAACC,KAAK,CAAE,0CAAyC,CAAC;IACzD;EACD;EAEA,IAAIT,MAAM,CAACa,QAAQ,IAAI,CAAC,IAAAC,kBAAU,EAACd,MAAM,CAACa,QAAQ,CAAC,EAAE;IACpDL,OAAO,CAACC,KAAK,CAAC,mDAAmD,CAAC;IAClE;EACD;EAEA,IAAI,CAACT,MAAM,CAACe,OAAO,EAAE;IACpBP,OAAO,CAACC,KAAK,CAAE,sCAAqC,CAAC;IACrD;EACD;EAEA,KAAK,MAAMO,OAAO,IAAIC,MAAM,CAACC,MAAM,CAAClB,MAAM,CAACe,OAAO,CAAC,EAAE;IACpD;EAAA;EAGDlB,qBAAqB,CAACE,IAAI,CAAC,GAAGC,MAAM;AACrC,CAAC;AAACmB,OAAA,CAAArB,4BAAA,GAAAA,4BAAA;AAEK,MAAMsB,wBAAwB,GAAGA,CAAA,KAA6B;EACpE,OAAOvB,qBAAqB;AAC7B,CAAC;AAACsB,OAAA,CAAAC,wBAAA,GAAAA,wBAAA;AAEK,MAAMC,uBAAuB,GAAItB,IAAY,IAAK;EACxD,OAAOF,qBAAqB,CAACE,IAAI,CAAC;AACnC,CAAC;AAACoB,OAAA,CAAAE,uBAAA,GAAAA,uBAAA","ignoreList":[]}