{"version":3,"names":["_useGeneralTheme","_interopRequireDefault","require","_config","_element","_data","_classnames","_reactLoaderSpinner","_emotion","Coupon","data","_data$payments$labels","_data$payments$labels2","_data$payments$labels3","generalTheme","useGeneralTheme","isPaying","setIsPaying","useState","showCoupon","setShowCoupon","coupon","setCoupon","error","setError","setPaymentData","useDispatch","applyCoupon","submission_id","hashed_id","response","fetch","configApi","getAdminUrl","method","body","URLSearchParams","action","submissionId","hashedId","result","json","success","UpdatedData","payments","discount_details","details","e","console","log","message","Error","_react","createElement","className","classnames","css","questionsColor","onClick","labels","discountQuestion","type","placeholder","discountPlaceholde","style","color","border","borderRadius","fontSize","padding","lineHeight","background","value","onChange","target","loading","buttonsBgColor","buttonsFontColor","id","TailSpin","height","width","Fragment","applyDiscount","_default","exports","default"],"sources":["@quillforms/renderer-core/src/components/payment-modal/coupon/index.tsx"],"sourcesContent":["/**\r\n * QuillForms Dependencies\r\n */\r\nimport useGeneralTheme from '../../../hooks/use-general-theme';\r\nimport configApi from '@quillforms/config';\r\n\r\n/**\r\n * WordPress Dependencies\r\n */\r\nimport { __ } from '@wordpress/i18n';\r\nimport { useState } from '@wordpress/element';\r\nimport { useDispatch } from '@wordpress/data';\r\n\r\n/**\r\n * External Dependencies\r\n */\r\nimport classnames from 'classnames';\r\nimport { TailSpin as Loader } from 'react-loader-spinner';\r\nimport { css } from 'emotion';\r\n\r\ninterface Props {\r\n\tdata: any;\r\n}\r\n\r\nconst Coupon: React.FC<Props> = ({ data }) => {\r\n\tconst generalTheme = useGeneralTheme();\r\n\tconst [isPaying, setIsPaying] = useState(false);\r\n\tconst [showCoupon, setShowCoupon] = useState(false);\r\n\tconst [coupon, setCoupon] = useState('');\r\n\tconst [error, setError] = useState('');\r\n\tconst { setPaymentData } = useDispatch('quillForms/renderer-core');\r\n\r\n\tconst applyCoupon = async () => {\r\n\t\tsetError('');\r\n\t\tsetIsPaying(true);\r\n\t\ttry {\r\n\t\t\tconst { submission_id, hashed_id } = data;\r\n\t\t\tlet response = await fetch(\r\n\t\t\t\tconfigApi.getAdminUrl() + 'admin-ajax.php',\r\n\t\t\t\t{\r\n\t\t\t\t\tmethod: 'POST',\r\n\t\t\t\t\tbody: new URLSearchParams({\r\n\t\t\t\t\t\taction: 'quillforms_apply_discount',\r\n\t\t\t\t\t\tsubmissionId: submission_id,\r\n\t\t\t\t\t\thashedId: hashed_id,\r\n\t\t\t\t\t\tcoupon,\r\n\t\t\t\t\t}),\r\n\t\t\t\t}\r\n\t\t\t);\r\n\r\n\t\t\tlet result = await response.json();\r\n\t\t\tif (result.success) {\r\n\t\t\t\t// Update new products\r\n\t\t\t\tconst UpdatedData = { ...data };\r\n\t\t\t\tUpdatedData.payments.discount_details = result.data.details;\r\n\t\t\t\tUpdatedData.payments.discount_details['coupon'] = coupon;\r\n\t\t\t\tsetPaymentData(UpdatedData);\r\n\t\t\t} else {\r\n\t\t\t\tsetError(result.data);\r\n\t\t\t}\r\n\t\t} catch (e) {\r\n\t\t\tconsole.log('applyCoupon: error throwed', e);\r\n\t\t\treturn {\r\n\t\t\t\tsuccess: false,\r\n\t\t\t\tmessage:\r\n\t\t\t\t\te instanceof Error && e.message\r\n\t\t\t\t\t\t? e.message\r\n\t\t\t\t\t\t: 'Unexpected error',\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\tsetIsPaying(false);\r\n\t\tsetCoupon('');\r\n\t};\r\n\treturn (\r\n\t\t<div className=\"renderer-core-payment-coupon\">\r\n\t\t\t<div\r\n\t\t\t\tclassName={classnames(\"renderer-core-payment-coupon__label\", css`\r\n\t\t\t\t\tcolor: ${generalTheme.questionsColor};\r\n\t\t\t\t`)}\r\n\t\t\t\tonClick={() => setShowCoupon(true)}\r\n\t\t\t>\r\n\t\t\t\t{data.payments.labels?.discountQuestion ?? 'You have a coupon?'}\r\n\t\t\t</div>\r\n\t\t\t{showCoupon && (\r\n\t\t\t\t<div className=\"render-core-payment-coupon-form\">\r\n\t\t\t\t\t<div className=\"renderer-core-payment-coupon__input\">\r\n\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\tplaceholder={data.payments.labels?.discountPlaceholde ?? 'Enter your discount code'}\r\n\t\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\t\tcolor: '#333',\r\n\t\t\t\t\t\t\t\tborder: `1px solid rgba(0, 0, 0, 0.3)`,\r\n\t\t\t\t\t\t\t\tborderRadius: '8px',\r\n\t\t\t\t\t\t\t\tfontSize: '16px',\r\n\t\t\t\t\t\t\t\tpadding: '10px 20px',\r\n\t\t\t\t\t\t\t\tlineHeight: '1',\r\n\t\t\t\t\t\t\t\tbackground: \"#fff\"\r\n\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\tclassName={classnames(\r\n\t\t\t\t\t\t\t\tcss`\r\n\t\t\t\t\t\t\t\t\t&:focus {\r\n\t\t\t\t\t\t\t\t\t\toutline: none;\r\n\t\t\t\t\t\t\t\t\t\tborder: 1px solid rgba( 0, 0, 0, 0.3 );\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t`\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\tvalue={coupon}\r\n\t\t\t\t\t\t\tonChange={(e) => setCoupon(e.target.value)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"renderer-core-payment-coupon__apply\">\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tclassName={classnames(\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tloading: isPaying,\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\tcss`\r\n\t\t\t\t\t\t\t\t\tborder-radius: 8px;\r\n\t\t\t\t\t\t\t\t\tbackground: ${generalTheme.buttonsBgColor};\r\n\t\t\t\t\t\t\t\t\tcolor: ${generalTheme.buttonsFontColor};\r\n\t\t\t\t\t\t\t\t\tborder: none;\r\n\t\t\t\t\t\t\t\t\tpadding: 10px 20px;\r\n\t\t\t\t\t\t\t\t\tfont-size: 16px;\r\n\t\t\t\t\t\t\t\t\tcursor: pointer;\r\n\t\t\t\t\t\t\t\t\t&.loading .renderer-core-arrow-icon {\r\n\t\t\t\t\t\t\t\t\t\tdisplay: none;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t`,\r\n\t\t\t\t\t\t\t\t'apply-coupon-button'\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\tonClick={() => applyCoupon()}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<span id=\"button-text\">\r\n\t\t\t\t\t\t\t\t{isPaying ? (\r\n\t\t\t\t\t\t\t\t\t<Loader\r\n\t\t\t\t\t\t\t\t\t\tcolor={generalTheme.buttonsFontColor}\r\n\t\t\t\t\t\t\t\t\t\theight={16}\r\n\t\t\t\t\t\t\t\t\t\twidth={16}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t<>{data.payments.labels?.applyDiscount ?? 'apply'} </>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\t\t\t{error && (\r\n\t\t\t\t<div\r\n\t\t\t\t\tclassName={classnames(\r\n\t\t\t\t\t\t'renderer-core-payment-coupon__error',\r\n\t\t\t\t\t\tcss`\r\n\t\t\t\t\t\t\tcolor: #a94442;\r\n\t\t\t\t\t\t\tfont-size: 14px;\r\n\t\t\t\t\t\t\tmargin-top: 10px;\r\n\t\t\t\t\t\t`\r\n\t\t\t\t\t)}\r\n\t\t\t\t>\r\n\t\t\t\t\t{error}\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default Coupon;\r\n"],"mappings":"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","ignoreList":[]}