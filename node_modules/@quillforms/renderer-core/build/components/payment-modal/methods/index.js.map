{"version":3,"names":["_paymentGateways","require","_button","_interopRequireDefault","_config","_radioControl","_element","_data","_i18n","_useGeneralTheme","_emotion","_lodash","_classnames","_reactLoaderSpinner","Methods","data","_urlParams$get","_data$payments$labels","_data$payments$labels2","setPaymentData","completeForm","useDispatch","generalTheme","useGeneralTheme","gateways","getPaymentGatewayModules","methodsKeys","Object","keys","payments","methods","options","map","key","gateway","method","split","label","customer","text","value","urlParams","URLSearchParams","window","location","search","defaultMethod","get","includes","_urlParams$get2","selected","setSelected","useState","CustomerRender","render","discountDetails","discount_details","discountAmount","amount","isPaying","setIsPaying","completeFullDiscountedOrders","submission_id","hashed_id","response","fetch","configApi","getAdminUrl","body","action","submissionId","hashedId","result","json","success","Error","message","e","console","log","_react","createElement","className","Fragment","size","css","questionsColor","labels","select_payment_method","default","id","onChange","slug","onComplete","classnames","loading","onClick","TailSpin","color","buttonsFontColor","height","width","pay","__","_default","exports"],"sources":["@quillforms/renderer-core/src/components/payment-modal/methods/index.tsx"],"sourcesContent":["/**\r\n * QuillForms Dependencies\r\n */\r\nimport { getPaymentGatewayModules } from '@quillforms/payment-gateways';\r\nimport Button from '../../button';\r\nimport configApi from '@quillforms/config';\r\n\r\n/**\r\n * WordPress Dependencies\r\n */\r\nimport RadioControl from './radio-control';\r\nimport { useState } from '@wordpress/element';\r\nimport { useDispatch } from '@wordpress/data';\r\nimport { __ } from '@wordpress/i18n';\r\nimport useGeneralTheme from '../../../hooks/use-general-theme';\r\n\r\n/**\r\n * External Dependencies\r\n */\r\nimport { css } from 'emotion';\r\nimport { size } from 'lodash';\r\nimport classnames from 'classnames';\r\nimport { TailSpin as Loader } from 'react-loader-spinner';\r\n\r\ninterface Props {\r\n\tdata: any;\r\n}\r\n\r\nconst Methods: React.FC<Props> = ({ data }) => {\r\n\tconst { setPaymentData, completeForm } = useDispatch(\r\n\t\t'quillForms/renderer-core'\r\n\t);\r\n\tconst generalTheme = useGeneralTheme();\r\n\r\n\tconst gateways = getPaymentGatewayModules();\r\n\tconst methodsKeys = Object.keys(data.payments.methods);\r\n\r\n\tconst options = methodsKeys.map((key) => {\r\n\t\tconst [gateway, method] = key.split(':');\r\n\t\treturn {\r\n\t\t\tlabel: gateways[gateway].methods[method].customer.label.text,\r\n\t\t\tvalue: key,\r\n\t\t};\r\n\t});\r\n\r\n\tconst urlParams = new URLSearchParams(window.location.search);\r\n\tlet defaultMethod = methodsKeys[0];\r\n\tif (\r\n\t\turlParams.get('step') === 'payment' &&\r\n\t\tmethodsKeys.includes(urlParams.get('method') ?? '')\r\n\t) {\r\n\t\tdefaultMethod = urlParams.get('method') ?? '';\r\n\t}\r\n\r\n\tconst [selected, setSelected] = useState(defaultMethod);\r\n\tconst [gateway, method] = selected.split(':');\r\n\r\n\tconst CustomerRender =\r\n\t\tgateways[gateway].methods[method].customer.render;\r\n\tconst discountDetails = data.payments?.discount_details;\r\n\tconst discountAmount = discountDetails?.amount;\r\n\tconst [isPaying, setIsPaying] = useState(false);\r\n\tconst completeFullDiscountedOrders = async () => {\r\n\t\tif (isPaying) return;\r\n\t\tsetIsPaying(true);\r\n\t\ttry {\r\n\t\t\tconst { submission_id, hashed_id } = data;\r\n\t\t\tlet response = await fetch(\r\n\t\t\t\tconfigApi.getAdminUrl() + 'admin-ajax.php',\r\n\t\t\t\t{\r\n\t\t\t\t\tmethod: 'POST',\r\n\t\t\t\t\tbody: new URLSearchParams({\r\n\t\t\t\t\t\taction: 'quillforms_complete_full_discounted_orders',\r\n\t\t\t\t\t\tsubmissionId: submission_id,\r\n\t\t\t\t\t\thashedId: hashed_id,\r\n\t\t\t\t\t}),\r\n\t\t\t\t}\r\n\t\t\t);\r\n\r\n\t\t\tlet result = await response.json();\r\n\t\t\tif (result.success) {\r\n\t\t\t\tcompleteForm();\r\n\t\t\t} else {\r\n\t\t\t\tthrow new Error(result.message);\r\n\t\t\t}\r\n\t\t} catch (e) {\r\n\t\t\tconsole.log('completePendingSubmission: error throwed', e);\r\n\t\t\treturn {\r\n\t\t\t\tsuccess: false,\r\n\t\t\t\tmessage:\r\n\t\t\t\t\te instanceof Error && e.message\r\n\t\t\t\t\t\t? e.message\r\n\t\t\t\t\t\t: 'Unexpected error',\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\tsetIsPaying(false);\r\n\t};\r\n\r\n\treturn (\r\n\t\t<div className=\"renderer-core-payment-modal-methods\">\r\n\t\t\t<>\r\n\t\t\t\t{size(methodsKeys) > 1 && (\r\n\t\t\t\t\t<>\r\n\t\t\t\t\t\t<p\r\n\t\t\t\t\t\t\tclassName={css`\r\n\t\t\t\t\t\t\t\tcolor: ${generalTheme.questionsColor};\r\n\t\t\t\t\t\t\t\tfont-size: 20px;\r\n\t\t\t\t\t\t\t` }\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{data.payments.labels?.select_payment_method ??\r\n\t\t\t\t\t\t\t\t'Select a payment method'}\r\n\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t<div className=\"renderer-components-radio-control__options-group\">\r\n\t\t\t\t\t\t\t<RadioControl\r\n\t\t\t\t\t\t\t\tid=\"payment-methods\"\r\n\t\t\t\t\t\t\t\tselected={selected}\r\n\t\t\t\t\t\t\t\toptions={options}\r\n\t\t\t\t\t\t\t\tonChange={setSelected}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</>\r\n\t\t\t\t)}\r\n\t\t\t</>\r\n\t\t\t{discountAmount !== 0 && (\r\n\t\t\t\t<CustomerRender\r\n\t\t\t\t\tslug={selected}\r\n\t\t\t\t\tdata={data}\r\n\t\t\t\t\tonComplete={() => {\r\n\t\t\t\t\t\tcompleteForm();\r\n\t\t\t\t\t\tsetPaymentData(null);\r\n\t\t\t\t\t}}\r\n\t\t\t\t/>\r\n\t\t\t)}\r\n\t\t\t{discountAmount === 0 && (\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\tclassName={classnames(\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tloading: isPaying,\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tcss`\r\n\t\t\t\t\t\t\t\t&.loading .renderer-core-arrow-icon {\r\n\t\t\t\t\t\t\t\t\tdisplay: none;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t`,\r\n\t\t\t\t\t\t\t'payment-button'\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\tcompleteFullDiscountedOrders();\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<span id=\"button-text\">\r\n\t\t\t\t\t\t\t{isPaying ? (\r\n\t\t\t\t\t\t\t\t<Loader\r\n\t\t\t\t\t\t\t\t\tcolor={generalTheme.buttonsFontColor}\r\n\t\t\t\t\t\t\t\t\theight={50}\r\n\t\t\t\t\t\t\t\t\twidth={50}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t{data?.payments?.labels?.pay ??\r\n\t\t\t\t\t\t\t\t\t\t__('Pay now', 'quillforms')}\r\n\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default Methods;\r\n"],"mappings":";;;;;;;;AAGA,IAAAA,gBAAA,GAAAC,OAAA;AACA,IAAAC,OAAA,GAAAC,sBAAA,CAAAF,OAAA;AACA,IAAAG,OAAA,GAAAD,sBAAA,CAAAF,OAAA;AAKA,IAAAI,aAAA,GAAAF,sBAAA,CAAAF,OAAA;AACA,IAAAK,QAAA,GAAAL,OAAA;AACA,IAAAM,KAAA,GAAAN,OAAA;AACA,IAAAO,KAAA,GAAAP,OAAA;AACA,IAAAQ,gBAAA,GAAAN,sBAAA,CAAAF,OAAA;AAKA,IAAAS,QAAA,GAAAT,OAAA;AACA,IAAAU,OAAA,GAAAV,OAAA;AACA,IAAAW,WAAA,GAAAT,sBAAA,CAAAF,OAAA;AACA,IAAAY,mBAAA,GAAAZ,OAAA;AAtBA;AACA;AACA;;AAKA;AACA;AACA;;AAOA;AACA;AACA;;AAUA,MAAMa,OAAwB,GAAGA,CAAC;EAAEC;AAAK,CAAC,KAAK;EAAA,IAAAC,cAAA,EAAAC,qBAAA,EAAAC,sBAAA;EAC9C,MAAM;IAAEC,cAAc;IAAEC;EAAa,CAAC,GAAG,IAAAC,iBAAW,EACnD,0BACD,CAAC;EACD,MAAMC,YAAY,GAAG,IAAAC,wBAAe,EAAC,CAAC;EAEtC,MAAMC,QAAQ,GAAG,IAAAC,yCAAwB,EAAC,CAAC;EAC3C,MAAMC,WAAW,GAAGC,MAAM,CAACC,IAAI,CAACb,IAAI,CAACc,QAAQ,CAACC,OAAO,CAAC;EAEtD,MAAMC,OAAO,GAAGL,WAAW,CAACM,GAAG,CAAEC,GAAG,IAAK;IACxC,MAAM,CAACC,OAAO,EAAEC,MAAM,CAAC,GAAGF,GAAG,CAACG,KAAK,CAAC,GAAG,CAAC;IACxC,OAAO;MACNC,KAAK,EAAEb,QAAQ,CAACU,OAAO,CAAC,CAACJ,OAAO,CAACK,MAAM,CAAC,CAACG,QAAQ,CAACD,KAAK,CAACE,IAAI;MAC5DC,KAAK,EAAEP;IACR,CAAC;EACF,CAAC,CAAC;EAEF,MAAMQ,SAAS,GAAG,IAAIC,eAAe,CAACC,MAAM,CAACC,QAAQ,CAACC,MAAM,CAAC;EAC7D,IAAIC,aAAa,GAAGpB,WAAW,CAAC,CAAC,CAAC;EAClC,IACCe,SAAS,CAACM,GAAG,CAAC,MAAM,CAAC,KAAK,SAAS,IACnCrB,WAAW,CAACsB,QAAQ,EAAAhC,cAAA,GAACyB,SAAS,CAACM,GAAG,CAAC,QAAQ,CAAC,cAAA/B,cAAA,cAAAA,cAAA,GAAI,EAAE,CAAC,EAClD;IAAA,IAAAiC,eAAA;IACDH,aAAa,IAAAG,eAAA,GAAGR,SAAS,CAACM,GAAG,CAAC,QAAQ,CAAC,cAAAE,eAAA,cAAAA,eAAA,GAAI,EAAE;EAC9C;EAEA,MAAM,CAACC,QAAQ,EAAEC,WAAW,CAAC,GAAG,IAAAC,iBAAQ,EAACN,aAAa,CAAC;EACvD,MAAM,CAACZ,OAAO,EAAEC,MAAM,CAAC,GAAGe,QAAQ,CAACd,KAAK,CAAC,GAAG,CAAC;EAE7C,MAAMiB,cAAc,GACnB7B,QAAQ,CAACU,OAAO,CAAC,CAACJ,OAAO,CAACK,MAAM,CAAC,CAACG,QAAQ,CAACgB,MAAM;EAClD,MAAMC,eAAe,GAAGxC,IAAI,CAACc,QAAQ,EAAE2B,gBAAgB;EACvD,MAAMC,cAAc,GAAGF,eAAe,EAAEG,MAAM;EAC9C,MAAM,CAACC,QAAQ,EAAEC,WAAW,CAAC,GAAG,IAAAR,iBAAQ,EAAC,KAAK,CAAC;EAC/C,MAAMS,4BAA4B,GAAG,MAAAA,CAAA,KAAY;IAChD,IAAIF,QAAQ,EAAE;IACdC,WAAW,CAAC,IAAI,CAAC;IACjB,IAAI;MACH,MAAM;QAAEE,aAAa;QAAEC;MAAU,CAAC,GAAGhD,IAAI;MACzC,IAAIiD,QAAQ,GAAG,MAAMC,KAAK,CACzBC,eAAS,CAACC,WAAW,CAAC,CAAC,GAAG,gBAAgB,EAC1C;QACChC,MAAM,EAAE,MAAM;QACdiC,IAAI,EAAE,IAAI1B,eAAe,CAAC;UACzB2B,MAAM,EAAE,4CAA4C;UACpDC,YAAY,EAAER,aAAa;UAC3BS,QAAQ,EAAER;QACX,CAAC;MACF,CACD,CAAC;MAED,IAAIS,MAAM,GAAG,MAAMR,QAAQ,CAACS,IAAI,CAAC,CAAC;MAClC,IAAID,MAAM,CAACE,OAAO,EAAE;QACnBtD,YAAY,CAAC,CAAC;MACf,CAAC,MAAM;QACN,MAAM,IAAIuD,KAAK,CAACH,MAAM,CAACI,OAAO,CAAC;MAChC;IACD,CAAC,CAAC,OAAOC,CAAC,EAAE;MACXC,OAAO,CAACC,GAAG,CAAC,0CAA0C,EAAEF,CAAC,CAAC;MAC1D,OAAO;QACNH,OAAO,EAAE,KAAK;QACdE,OAAO,EACNC,CAAC,YAAYF,KAAK,IAAIE,CAAC,CAACD,OAAO,GAC5BC,CAAC,CAACD,OAAO,GACT;MACL,CAAC;IACF;IAEAhB,WAAW,CAAC,KAAK,CAAC;EACnB,CAAC;EAED,OACC,IAAAoB,MAAA,CAAAC,aAAA;IAAKC,SAAS,EAAC;EAAqC,GACnD,IAAAF,MAAA,CAAAC,aAAA,EAAAD,MAAA,CAAAG,QAAA,QACE,IAAAC,YAAI,EAAC1D,WAAW,CAAC,GAAG,CAAC,IACrB,IAAAsD,MAAA,CAAAC,aAAA,EAAAD,MAAA,CAAAG,QAAA,QACC,IAAAH,MAAA,CAAAC,aAAA;IACCC,SAAS,EAAE,IAAAG,YAAG,CAAC;AACtB,iBAAiB/D,YAAY,CAACgE,cAAe;AAC7C;AACA;EAAU,IAAArE,qBAAA,GAEFF,IAAI,CAACc,QAAQ,CAAC0D,MAAM,EAAEC,qBAAqB,cAAAvE,qBAAA,cAAAA,qBAAA,GAC3C,yBACC,CAAC,EACJ,IAAA+D,MAAA,CAAAC,aAAA;IAAKC,SAAS,EAAC;EAAkD,GAChE,IAAAF,MAAA,CAAAC,aAAA,EAAC5E,aAAA,CAAAoF,OAAY;IACZC,EAAE,EAAC,iBAAiB;IACpBxC,QAAQ,EAAEA,QAAS;IACnBnB,OAAO,EAAEA,OAAQ;IACjB4D,QAAQ,EAAExC;EAAY,CACtB,CACG,CACJ,CAEF,CAAC,EACFM,cAAc,KAAK,CAAC,IACpB,IAAAuB,MAAA,CAAAC,aAAA,EAAC5B,cAAc;IACduC,IAAI,EAAE1C,QAAS;IACfnC,IAAI,EAAEA,IAAK;IACX8E,UAAU,EAAEA,CAAA,KAAM;MACjBzE,YAAY,CAAC,CAAC;MACdD,cAAc,CAAC,IAAI,CAAC;IACrB;EAAE,CACF,CACD,EACAsC,cAAc,KAAK,CAAC,IACpB,IAAAuB,MAAA,CAAAC,aAAA,eACC,IAAAD,MAAA,CAAAC,aAAA,EAAC/E,OAAA,CAAAuF,OAAM;IACNP,SAAS,EAAE,IAAAY,mBAAU,EACpB;MACCC,OAAO,EAAEpC;IACV,CAAC,EACD,IAAA0B,YAAG,CAAC;AACX;AACA;AACA;AACA,QAAQ,EACD,gBACD,CAAE;IACFW,OAAO,EAAEA,CAAA,KAAM;MACdnC,4BAA4B,CAAC,CAAC;IAC/B;EAAE,GAEF,IAAAmB,MAAA,CAAAC,aAAA;IAAMS,EAAE,EAAC;EAAa,GACpB/B,QAAQ,GACR,IAAAqB,MAAA,CAAAC,aAAA,EAACpE,mBAAA,CAAAoF,QAAM;IACNC,KAAK,EAAE5E,YAAY,CAAC6E,gBAAiB;IACrCC,MAAM,EAAE,EAAG;IACXC,KAAK,EAAE;EAAG,CACV,CAAC,GAEF,IAAArB,MAAA,CAAAC,aAAA,EAAAD,MAAA,CAAAG,QAAA,SAAAjE,sBAAA,GACEH,IAAI,EAAEc,QAAQ,EAAE0D,MAAM,EAAEe,GAAG,cAAApF,sBAAA,cAAAA,sBAAA,GAC3B,IAAAqF,QAAE,EAAC,SAAS,EAAE,YAAY,CAC1B,CAEE,CACC,CACJ,CAEF,CAAC;AAER,CAAC;AAAC,IAAAC,QAAA,GAAAC,OAAA,CAAAhB,OAAA,GAEa3E,OAAO","ignoreList":[]}