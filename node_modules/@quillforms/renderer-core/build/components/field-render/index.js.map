{"version":3,"names":["_element","require","_data","_context","_fieldWrapper","_interopRequireDefault","FieldRender","id","isActive","isLastField","shouldBeRendered","isCurrentBlockSafeToSwipe","next","isSubmitBtnVisible","showNextBtn","useState","isErrMsgVisible","showErrMsg","isReviewing","isValid","block","firstInvalidFieldId","lastFieldId","useSelect","select","walkPath","getWalkPath","isValidField","getBlockById","getFirstInvalidFieldId","length","goToBlock","setIsCurrentBlockSafeToSwipe","useDispatch","useEffect","name","attributes","innerBlocks","context","blockName","_react","createElement","FieldRenderContextProvider","value","default","_default","exports"],"sources":["@quillforms/renderer-core/src/components/field-render/index.tsx"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { useState, useEffect } from '@wordpress/element';\r\nimport { useSelect, useDispatch } from '@wordpress/data';\r\n/**\r\n * Internal dependencies\r\n */\r\nimport {\r\n\tFieldRenderContextProvider,\r\n\t__experimentalUseFieldRenderContext,\r\n} from './context';\r\nimport FieldWrapper from '../field-wrapper';\r\n\r\nexport { __experimentalUseFieldRenderContext };\r\n\r\ninterface Props {\r\n\tid: string;\r\n\tisActive: boolean;\r\n\tshouldBeRendered: boolean;\r\n\tisLastField: boolean;\r\n\tisCurrentBlockSafeToSwipe: boolean;\r\n\tnext: Function;\r\n}\r\n\r\nconst FieldRender: React.FC<Props> =\r\n\t({\r\n\t\tid,\r\n\t\tisActive,\r\n\t\tisLastField,\r\n\t\tshouldBeRendered,\r\n\t\tisCurrentBlockSafeToSwipe,\r\n\t\tnext,\r\n\t}) => {\r\n\t\tconst [isSubmitBtnVisible, showNextBtn] = useState<boolean>(true);\r\n\t\tconst [isErrMsgVisible, showErrMsg] = useState<boolean>(false);\r\n\r\n\t\tconst {\r\n\t\t\tisReviewing,\r\n\t\t\tisValid,\r\n\t\t\tblock,\r\n\t\t\tfirstInvalidFieldId,\r\n\t\t\tlastFieldId,\r\n\t\t} = useSelect((select) => {\r\n\t\t\tconst walkPath = select('quillForms/renderer-core').getWalkPath();\r\n\t\t\treturn {\r\n\t\t\t\tisReviewing: select('quillForms/renderer-core').isReviewing(),\r\n\t\t\t\tisValid: select('quillForms/renderer-core').isValidField(\r\n\t\t\t\t\tid\r\n\t\t\t\t),\r\n\t\t\t\tblock: select('quillForms/renderer-core').getBlockById(id),\r\n\t\t\t\tfirstInvalidFieldId: select(\r\n\t\t\t\t\t'quillForms/renderer-core'\r\n\t\t\t\t).getFirstInvalidFieldId(),\r\n\t\t\t\tlastFieldId: walkPath[walkPath.length - 1].id,\r\n\t\t\t};\r\n\t\t});\r\n\r\n\t\tconst { goToBlock, setIsCurrentBlockSafeToSwipe } = useDispatch(\r\n\t\t\t'quillForms/renderer-core'\r\n\t\t);\r\n\r\n\t\tuseEffect(() => {\r\n\t\t\tif (isActive && !isReviewing && !isErrMsgVisible) {\r\n\t\t\t\tshowErrMsg(false);\r\n\t\t\t\tsetIsCurrentBlockSafeToSwipe(true);\r\n\t\t\t}\r\n\t\t}, [isActive, isErrMsgVisible, isReviewing]);\r\n\r\n\t\tuseEffect(() => {\r\n\t\t\tif (!isCurrentBlockSafeToSwipe) {\r\n\t\t\t\tshowErrMsg(true);\r\n\t\t\t}\r\n\t\t}, [isCurrentBlockSafeToSwipe]);\r\n\t\tuseEffect(() => {\r\n\t\t\tif (isReviewing && !isValid) {\r\n\t\t\t\tshowErrMsg(true);\r\n\t\t\t}\r\n\t\t}, [isReviewing, isValid]);\r\n\r\n\t\tif (!block) return null;\r\n\t\t//console.log( block );\r\n\t\tconst { name, attributes, innerBlocks } = block;\r\n\r\n\t\tconst context = {\r\n\t\t\tid,\r\n\t\t\tblockName: name,\r\n\t\t\tattributes,\r\n\t\t\tinnerBlocks,\r\n\t\t\tisActive,\r\n\t\t\tshouldBeRendered,\r\n\t\t\tisErrMsgVisible,\r\n\t\t\tshowErrMsg,\r\n\t\t\tisSubmitBtnVisible,\r\n\t\t\tshowNextBtn,\r\n\t\t\tnext: () => {\r\n\t\t\t\tif (!isReviewing) {\r\n\t\t\t\t\tnext();\r\n\t\t\t\t} else if (firstInvalidFieldId) {\r\n\t\t\t\t\tgoToBlock(firstInvalidFieldId);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tgoToBlock(lastFieldId);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tisLastField,\r\n\t\t};\r\n\t\treturn (\r\n\t\t\t<FieldRenderContextProvider value={context}>\r\n\t\t\t\t<FieldWrapper />\r\n\t\t\t</FieldRenderContextProvider>\r\n\t\t);\r\n\t};\r\n\r\nexport default FieldRender;\r\n"],"mappings":"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","ignoreList":[]}