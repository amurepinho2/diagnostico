{"version":3,"names":["_data","require","_element","_hooks","_classnames","_interopRequireDefault","_reactSwipeable","_lethargy","_jsCookie","_fieldRender","_hooks2","_useCorrectIncorrectQuiz","lastScrollDate","lethargy","Lethargy","FieldsWrapper","applyLogic","isActive","beforeGoingNext","isPreview","formId","useFormContext","blocks","useBlocks","blockTypes","useBlockTypes","logic","useLogic","hiddenFields","useHiddenFields","correctIncorrectQuiz","useCorrectIncorrectQuiz","settings","useFormSettings","formObj","saveandcontinue","saved_data","editableFields","useEditableFields","ref","useRef","swiper","useSelect","select","getSwiperState","walkPath","currentBlockId","nextBlockId","prevBlockId","lastActiveBlockId","canSwipeNext","canSwipePrev","isAnimating","isCurrentBlockSafeToSwipe","answers","getAnswers","currentBlockIndex","findIndex","block","id","nextBlock","getBlockById","undefined","currentBlockName","name","currentBlockType","lastActiveBlockIndex","setSwiper","goNext","goPrev","goToBlock","setIsCurrentBlockSafeToSwipe","setIsFieldValid","setIsFieldPending","setFieldValidationErr","setFieldAnswer","setCorrectIncorrectDisplay","setIsFieldCorrectIncorrectScreenDisplayed","useDispatch","useEffect","enable","snapshot","fields","Object","keys","forEach","fieldId","value","saveAnswersInBrowser","Cookies","get","JSON","parse","field","set","stringify","expires","path","isTouchScreen","window","navigator","maxTouchPoints","msMaxTouchPoints","getFieldsToRender","fieldIds","filteredBlocks","filter","isPending","push","fieldsToRender","goNextReally","setIsPending","val","enabled","correctIncorrectDisplay","supports","correctAnswers","showAnswersDuringQuiz","isCorrectIncorrectScreenDisplayed","isCurrentBlockValid","innerBlocks","hasValidFields","editable","isValidField","isFirstField","length","isLastField","handlers","useSwipeable","onSwiping","e","swipingHandler","preventDefaultTouchmoveEvent","trackMouse","trackTouch","delta","touch","disableWheelSwiping","deltaY","animationDirection","deltaX","lethargyCheck","check","now","Date","getTime","timeDelay","dir","timer","setTimeout","clearTimeout","doAction","handleNext","_react","createElement","onWheel","className","classNames","active","map","index","default","key","shouldBeRendered","includes","next","_default","exports"],"sources":["@quillforms/renderer-core/src/components/fields-wrapper/index.tsx"],"sourcesContent":["/* eslint-disable no-nested-ternary */\r\n/**\r\n * Wordpress Dependencies\r\n */\r\nimport { useSelect, useDispatch } from '@wordpress/data';\r\nimport { useEffect, useRef, useState } from '@wordpress/element';\r\nimport { doAction } from '@wordpress/hooks';\r\n\r\n/**\r\n * External Dependencies\r\n */\r\nimport classNames from 'classnames';\r\nimport { useSwipeable, SwipeEventData } from 'react-swipeable';\r\nimport { Lethargy } from 'lethargy';\r\nimport type React from 'react';\r\nimport Cookies from 'js-cookie';\r\n\r\n/**\r\n * Internal Dependencies\r\n */\r\nimport FieldRender from '../field-render';\r\nimport {\r\n\tuseBlocks,\r\n\tuseBlockTypes,\r\n\tuseFormSettings,\r\n\tuseLogic,\r\n\tuseHiddenFields,\r\n\tuseFormContext,\r\n\tuseEditableFields,\r\n} from '../../hooks';\r\nimport useCorrectIncorrectQuiz from '../../hooks/use-correct-incorrect-quiz';\r\n\r\nlet lastScrollDate = 0;\r\nconst lethargy = new Lethargy();\r\n\r\ninterface Props {\r\n\tapplyLogic: boolean;\r\n\tisActive: boolean;\r\n}\r\n\r\nconst FieldsWrapper: React.FC< Props > = ( { applyLogic, isActive } ) => {\r\n\tconst { beforeGoingNext, isPreview, formId } = useFormContext();\r\n\tconst blocks = useBlocks();\r\n\tconst blockTypes = useBlockTypes();\r\n\tconst logic = useLogic();\r\n\tconst hiddenFields = useHiddenFields();\r\n\tconst correctIncorrectQuiz = useCorrectIncorrectQuiz();\r\n\tconst settings = useFormSettings();\r\n\tconst { formObj } = useFormContext();\r\n\t// @ts-ignore saveandcontinue is a property of formObj.\r\n\tconst { saveandcontinue = {} } = formObj;\r\n\t// @ts-ignore saved_data is a property of formObj.\r\n\tconst { saved_data = {} } = formObj;\r\n\tconst editableFields = useEditableFields( true );\r\n\r\n\tconst ref = useRef< HTMLDivElement | null >( null );\r\n\tconst { swiper } = useSelect( ( select ) => {\r\n\t\treturn {\r\n\t\t\tswiper: select( 'quillForms/renderer-core' ).getSwiperState(),\r\n\t\t};\r\n\t} );\r\n\r\n\tconst {\r\n\t\twalkPath,\r\n\t\tcurrentBlockId,\r\n\t\tnextBlockId,\r\n\t\tprevBlockId,\r\n\t\tlastActiveBlockId,\r\n\t\tcanSwipeNext,\r\n\t\tcanSwipePrev,\r\n\t\tisAnimating,\r\n\t\tisCurrentBlockSafeToSwipe,\r\n\t} = swiper;\r\n\r\n\tconst { answers } = useSelect( ( select ) => {\r\n\t\treturn {\r\n\t\t\tanswers: select( 'quillForms/renderer-core' ).getAnswers(),\r\n\t\t};\r\n\t} );\r\n\tconst currentBlockIndex = walkPath.findIndex(\r\n\t\t( block ) => block.id === currentBlockId\r\n\t);\r\n\r\n\tconst { nextBlock } = useSelect( ( select ) => {\r\n\t\treturn {\r\n\t\t\tnextBlock: nextBlockId\r\n\t\t\t\t? select( 'quillForms/renderer-core' ).getBlockById(\r\n\t\t\t\t\t\tnextBlockId\r\n\t\t\t\t  )\r\n\t\t\t\t: undefined,\r\n\t\t};\r\n\t} );\r\n\tconst currentBlockName = walkPath[ currentBlockIndex ]?.name;\r\n\r\n\tconst currentBlockType = blockTypes?.[ currentBlockName ];\r\n\r\n\tconst lastActiveBlockIndex = walkPath.findIndex(\r\n\t\t( block ) => block.id === lastActiveBlockId\r\n\t);\r\n\r\n\tconst {\r\n\t\tsetSwiper,\r\n\t\tgoNext,\r\n\t\tgoPrev,\r\n\t\tgoToBlock,\r\n\t\tsetIsCurrentBlockSafeToSwipe,\r\n\t\tsetIsFieldValid,\r\n\t\tsetIsFieldPending,\r\n\t\tsetFieldValidationErr,\r\n\t\tsetFieldAnswer,\r\n\t\tsetCorrectIncorrectDisplay,\r\n\t\tsetIsFieldCorrectIncorrectScreenDisplayed,\r\n\t} = useDispatch( 'quillForms/renderer-core' );\r\n\r\n\tuseEffect( () => {\r\n\t\tif ( saveandcontinue?.enable && saved_data?.snapshot ) {\r\n\t\t\tconst fields = saved_data?.fields || {};\r\n\r\n\t\t\tObject.keys( fields ).forEach( ( fieldId ) => {\r\n\t\t\t\tsetFieldAnswer( fieldId, fields[ fieldId ].value );\r\n\t\t\t} );\r\n\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif ( settings?.saveAnswersInBrowser && ! isPreview ) {\r\n\t\t\t// replace localstorage with cookies.\r\n\t\t\tconst answers = Cookies.get( `quillforms-answers-${ formId }` )\r\n\t\t\t\t? JSON.parse( Cookies.get( `quillforms-answers-${ formId }` ) )\r\n\t\t\t\t: {};\r\n\t\t\teditableFields.forEach( ( field ) => {\r\n\t\t\t\tif ( answers[ field.id ] ) {\r\n\t\t\t\t\tsetFieldAnswer( field.id, answers[ field.id ].value );\r\n\t\t\t\t}\r\n\t\t\t} );\r\n\t\t}\r\n\t}, [] );\r\n\r\n\tuseEffect( () => {\r\n\t\tif ( ! isPreview && settings?.saveAnswersInBrowser ) {\r\n\t\t\t// replace localstorage with cookies which will expire in 30 days.\r\n\t\t\tCookies.set(\r\n\t\t\t\t`quillforms-answers-${ formId }`,\r\n\t\t\t\tJSON.stringify( answers ),\r\n\t\t\t\t{ expires: 30 },\r\n\t\t\t\t{ path: '/' }\r\n\t\t\t);\r\n\t\t\tCookies.set(\r\n\t\t\t\t`quillforms-current-block-${ formId }`,\r\n\t\t\t\tcurrentBlockId,\r\n\t\t\t\t{ expires: 30 },\r\n\t\t\t\t{ path: '/' }\r\n\t\t\t);\r\n\t\t}\r\n\t}, [ currentBlockId, answers ] );\r\n\tconst isTouchScreen =\r\n\t\t( typeof window !== 'undefined' && 'ontouchstart' in window ) ||\r\n\t\t( typeof navigator !== 'undefined' && navigator.maxTouchPoints > 0 ) || // @ts-expect-error\r\n\t\t( typeof navigator !== 'undefined' && navigator.msMaxTouchPoints > 0 );\r\n\r\n\tconst getFieldsToRender = (): string[] => {\r\n\t\tconst fieldIds: string[] = [];\r\n\t\tconst filteredBlocks = walkPath.filter(\r\n\t\t\t( block ) =>\r\n\t\t\t\tanswers[ block.id ]?.isPending ||\r\n\t\t\t\tblock.id === currentBlockId ||\r\n\t\t\t\t( ! isTouchScreen && block.id === nextBlockId ) ||\r\n\t\t\t\t( ! isTouchScreen && block.id === prevBlockId ) ||\r\n\t\t\t\t( ! isTouchScreen && block.id === lastActiveBlockId )\r\n\t\t);\r\n\t\tfilteredBlocks.forEach( ( block ) => {\r\n\t\t\tif (\r\n\t\t\t\tblock.name !== 'welcome-screen' &&\r\n\t\t\t\tblock.name !== 'thankyou-screen'\r\n\t\t\t) {\r\n\t\t\t\tfieldIds.push( block.id );\r\n\t\t\t}\r\n\t\t} );\r\n\t\treturn fieldIds;\r\n\t};\r\n\r\n\tconst fieldsToRender = getFieldsToRender();\r\n\tconst fields = walkPath.filter(\r\n\t\t( block ) =>\r\n\t\t\tblock.name !== 'welcome-screen' && block.name !== 'thankyou-screen'\r\n\t);\r\n\r\n\tconst goNextReally = async () => {\r\n\t\tif ( answers[ currentBlockIndex ]?.isPending ) return;\r\n\t\tif ( beforeGoingNext && currentBlockId ) {\r\n\t\t\tawait beforeGoingNext( {\r\n\t\t\t\tanswers,\r\n\t\t\t\tcurrentBlockId,\r\n\t\t\t\tsetIsFieldValid,\r\n\t\t\t\tsetFieldValidationErr,\r\n\t\t\t\tsetIsCurrentBlockSafeToSwipe,\r\n\t\t\t\tgoToBlock,\r\n\t\t\t\tgoNext,\r\n\t\t\t\tsetIsPending: ( val ) =>\r\n\t\t\t\t\tsetIsFieldPending( currentBlockId, val ),\r\n\t\t\t} );\r\n\t\t} else {\r\n\t\t\tif (\r\n\t\t\t\tcorrectIncorrectQuiz?.enabled &&\r\n\t\t\t\tswiper?.correctIncorrectDisplay === false &&\r\n\t\t\t\tcurrentBlockType.supports.correctAnswers &&\r\n\t\t\t\tcorrectIncorrectQuiz?.showAnswersDuringQuiz &&\r\n\t\t\t\t! answers[ currentBlockId ]?.isCorrectIncorrectScreenDisplayed\r\n\t\t\t) {\r\n\t\t\t\tsetCorrectIncorrectDisplay( true );\r\n\t\t\t\tsetIsFieldCorrectIncorrectScreenDisplayed(\r\n\t\t\t\t\tcurrentBlockId,\r\n\t\t\t\t\ttrue\r\n\t\t\t\t);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tgoNext();\r\n\t\t}\r\n\t};\r\n\r\n\tconst { isCurrentBlockValid } = useSelect( ( select ) => {\r\n\t\treturn {\r\n\t\t\tisCurrentBlockValid: currentBlockType?.supports?.innerBlocks\r\n\t\t\t\t? select( 'quillForms/renderer-core' )?.hasValidFields(\r\n\t\t\t\t\t\t// @ts-expect-error\r\n\t\t\t\t\t\tcurrentBlockId\r\n\t\t\t\t  )\r\n\t\t\t\t: currentBlockType?.supports?.editable\r\n\t\t\t\t? select( 'quillForms/renderer-core' )?.isValidField(\r\n\t\t\t\t\t\t// @ts-expect-error\r\n\t\t\t\t\t\tcurrentBlockId\r\n\t\t\t\t  )\r\n\t\t\t\t: true,\r\n\t\t};\r\n\t} );\r\n\tuseEffect( () => {\r\n\t\tif ( isCurrentBlockSafeToSwipe ) setIsCurrentBlockSafeToSwipe( true );\r\n\t}, [ isCurrentBlockValid ] );\r\n\r\n\tconst isFirstField =\r\n\t\twalkPath?.length > 0 && walkPath[ 0 ].id === currentBlockId;\r\n\r\n\tconst isLastField =\r\n\t\twalkPath?.length &&\r\n\t\tcurrentBlockId === walkPath[ walkPath.length - 1 ].id;\r\n\r\n\tconst handlers = useSwipeable( {\r\n\t\tonSwiping: ( e ) => {\r\n\t\t\tswipingHandler( e, true );\r\n\t\t},\r\n\t\tpreventDefaultTouchmoveEvent: false,\r\n\t\ttrackMouse: false,\r\n\t\ttrackTouch: true,\r\n\t\tdelta: 70,\r\n\t} );\r\n\r\n\t// Mouse Wheel Handler\r\n\tconst swipingHandler = (\r\n\t\te: React.WheelEvent | SwipeEventData,\r\n\t\ttouch = false\r\n\t) => {\r\n\t\tif ( settings?.disableWheelSwiping ) return;\r\n\t\tlet delta = e.deltaY;\r\n\t\tif ( settings?.animationDirection === 'horizontal' ) {\r\n\t\t\tdelta = e.deltaX;\r\n\t\t}\r\n\t\tif ( swiper.isAnimating ) return;\r\n\t\tconst lethargyCheck = lethargy.check( e );\r\n\t\tconst now = new Date().getTime();\r\n\t\tlet timeDelay = 900;\r\n\t\tif ( touch ) timeDelay = 500;\r\n\t\tif (\r\n\t\t\tlethargyCheck === false ||\r\n\t\t\tisAnimating ||\r\n\t\t\t( lastScrollDate && now - lastScrollDate < timeDelay )\r\n\t\t)\r\n\t\t\treturn;\r\n\t\tif (\r\n\t\t\tcanSwipePrev &&\r\n\t\t\t( ( delta < -50 && ! touch ) ||\r\n\t\t\t\t( touch &&\r\n\t\t\t\t\tdelta > 50 &&\r\n\t\t\t\t\t( e as SwipeEventData ).dir === 'Down' ) ) &&\r\n\t\t\t! isFirstField\r\n\t\t) {\r\n\t\t\t// Scroll up\r\n\t\t\tlastScrollDate = new Date().getTime();\r\n\t\t\tgoPrev();\r\n\t\t} else if (\r\n\t\t\tcanSwipeNext &&\r\n\t\t\t( ( delta < -50 &&\r\n\t\t\t\ttouch &&\r\n\t\t\t\t( e as SwipeEventData ).dir === 'Up' ) ||\r\n\t\t\t\t( ! touch && delta > 50 ) ) &&\r\n\t\t\t! isLastField\r\n\t\t) {\r\n\t\t\tlastScrollDate = new Date().getTime();\r\n\t\t\t// Scroll down\r\n\t\t\tif ( isCurrentBlockValid ) {\r\n\t\t\t\tgoNextReally();\r\n\t\t\t} else {\r\n\t\t\t\tsetIsCurrentBlockSafeToSwipe( false );\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tuseEffect( (): void | ( () => void ) => {\r\n\t\tif ( isAnimating ) {\r\n\t\t\tconst timer = setTimeout( () => {\r\n\t\t\t\tsetSwiper( {\r\n\t\t\t\t\tisAnimating: false,\r\n\t\t\t\t} );\r\n\t\t\t}, 600 );\r\n\t\t\treturn () => clearTimeout( timer );\r\n\t\t}\r\n\t}, [ swiper ] );\r\n\r\n\tuseEffect( () => {\r\n\t\tif ( applyLogic && isActive ) {\r\n\t\t\tdoAction(\r\n\t\t\t\t'QuillForms.RendererCore.LogicApply',\r\n\t\t\t\tblocks,\r\n\t\t\t\tblockTypes,\r\n\t\t\t\tlogic,\r\n\t\t\t\thiddenFields\r\n\t\t\t);\r\n\t\t}\r\n\t}, [ answers, currentBlockId ] );\r\n\r\n\tuseEffect( () => {\r\n\t\tif ( applyLogic && isActive ) {\r\n\t\t\tsetSwiper( {\r\n\t\t\t\tcurrentBlockId: blocks[ 0 ].id,\r\n\t\t\t\tprevBlockId: undefined,\r\n\t\t\t\tcanSwipePrev: false,\r\n\t\t\t\tlastActiveBlockId: undefined,\r\n\t\t\t} );\r\n\t\t\tdoAction(\r\n\t\t\t\t'QuillForms.RendererCore.LogicApply',\r\n\t\t\t\tblocks,\r\n\t\t\t\tblockTypes,\r\n\t\t\t\tlogic,\r\n\t\t\t\thiddenFields\r\n\t\t\t);\r\n\t\t}\r\n\t\tif ( ! applyLogic ) {\r\n\t\t\tdoAction( 'QuillForms.RendererCore.LogicTurnOff' );\r\n\t\t}\r\n\t}, [ applyLogic ] );\r\n\r\n\t// const isThereNextField =\r\n\t// \tfields.filter( ( field ) => field.id === nextBlockId ).length === 0;\r\n\r\n\tconst handleNext = () => {\r\n\t\tif ( isCurrentBlockValid ) {\r\n\t\t\tgoNextReally();\r\n\t\t} else {\r\n\t\t\tsetIsCurrentBlockSafeToSwipe( false );\r\n\t\t}\r\n\t};\r\n\treturn (\r\n\t\t<div\r\n\t\t\tonWheel={ swipingHandler }\r\n\t\t\tclassName={ classNames( 'renderer-core-fields-wrapper', {\r\n\t\t\t\tactive: isActive,\r\n\t\t\t\t'is-moving-up':\r\n\t\t\t\t\tisAnimating && currentBlockIndex < lastActiveBlockIndex,\r\n\t\t\t\t'is-moving-down':\r\n\t\t\t\t\tisAnimating && currentBlockIndex > lastActiveBlockIndex,\r\n\t\t\t} ) }\r\n\t\t\tref={ ref }\r\n\t\t\taria-hidden={ isActive ? false : true }\r\n\t\t>\r\n\t\t\t<div { ...handlers }>\r\n\t\t\t\t{ fields.map( ( field, index ) => {\r\n\t\t\t\t\tconst isActive = currentBlockId === field.id;\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t<FieldRender\r\n\t\t\t\t\t\t\tkey={ `${ field.id }` }\r\n\t\t\t\t\t\t\tid={ field.id }\r\n\t\t\t\t\t\t\tshouldBeRendered={ fieldsToRender.includes(\r\n\t\t\t\t\t\t\t\tfield.id\r\n\t\t\t\t\t\t\t) }\r\n\t\t\t\t\t\t\tisActive={ isActive }\r\n\t\t\t\t\t\t\tisCurrentBlockSafeToSwipe={\r\n\t\t\t\t\t\t\t\tisActive ? isCurrentBlockSafeToSwipe : true\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tisLastField={\r\n\t\t\t\t\t\t\t\t( ! nextBlock ||\r\n\t\t\t\t\t\t\t\t\tnextBlock.name === 'thankyou-screen' ) &&\r\n\t\t\t\t\t\t\t\tindex === fields.length - 1\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tnext={ () => handleNext() }\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t);\r\n\t\t\t\t} ) }\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\nexport default FieldsWrapper;\r\n"],"mappings":"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","ignoreList":[]}