{"version":3,"names":["useSelect","useDispatch","useEffect","useRef","doAction","classNames","useSwipeable","Lethargy","Cookies","FieldRender","useBlocks","useBlockTypes","useFormSettings","useLogic","useHiddenFields","useFormContext","useEditableFields","useCorrectIncorrectQuiz","lastScrollDate","lethargy","FieldsWrapper","applyLogic","isActive","beforeGoingNext","isPreview","formId","blocks","blockTypes","logic","hiddenFields","correctIncorrectQuiz","settings","formObj","saveandcontinue","saved_data","editableFields","ref","swiper","select","getSwiperState","walkPath","currentBlockId","nextBlockId","prevBlockId","lastActiveBlockId","canSwipeNext","canSwipePrev","isAnimating","isCurrentBlockSafeToSwipe","answers","getAnswers","currentBlockIndex","findIndex","block","id","nextBlock","getBlockById","undefined","currentBlockName","name","currentBlockType","lastActiveBlockIndex","setSwiper","goNext","goPrev","goToBlock","setIsCurrentBlockSafeToSwipe","setIsFieldValid","setIsFieldPending","setFieldValidationErr","setFieldAnswer","setCorrectIncorrectDisplay","setIsFieldCorrectIncorrectScreenDisplayed","enable","snapshot","fields","Object","keys","forEach","fieldId","value","saveAnswersInBrowser","get","JSON","parse","field","set","stringify","expires","path","isTouchScreen","window","navigator","maxTouchPoints","msMaxTouchPoints","getFieldsToRender","fieldIds","filteredBlocks","filter","isPending","push","fieldsToRender","goNextReally","setIsPending","val","enabled","correctIncorrectDisplay","supports","correctAnswers","showAnswersDuringQuiz","isCorrectIncorrectScreenDisplayed","isCurrentBlockValid","innerBlocks","hasValidFields","editable","isValidField","isFirstField","length","isLastField","handlers","onSwiping","e","swipingHandler","preventDefaultTouchmoveEvent","trackMouse","trackTouch","delta","touch","disableWheelSwiping","deltaY","animationDirection","deltaX","lethargyCheck","check","now","Date","getTime","timeDelay","dir","timer","setTimeout","clearTimeout","handleNext","createElement","onWheel","className","active","map","index","key","shouldBeRendered","includes","next"],"sources":["@quillforms/renderer-core/src/components/fields-wrapper/index.tsx"],"sourcesContent":["/* eslint-disable no-nested-ternary */\r\n/**\r\n * Wordpress Dependencies\r\n */\r\nimport { useSelect, useDispatch } from '@wordpress/data';\r\nimport { useEffect, useRef, useState } from '@wordpress/element';\r\nimport { doAction } from '@wordpress/hooks';\r\n\r\n/**\r\n * External Dependencies\r\n */\r\nimport classNames from 'classnames';\r\nimport { useSwipeable, SwipeEventData } from 'react-swipeable';\r\nimport { Lethargy } from 'lethargy';\r\nimport type React from 'react';\r\nimport Cookies from 'js-cookie';\r\n\r\n/**\r\n * Internal Dependencies\r\n */\r\nimport FieldRender from '../field-render';\r\nimport {\r\n\tuseBlocks,\r\n\tuseBlockTypes,\r\n\tuseFormSettings,\r\n\tuseLogic,\r\n\tuseHiddenFields,\r\n\tuseFormContext,\r\n\tuseEditableFields,\r\n} from '../../hooks';\r\nimport useCorrectIncorrectQuiz from '../../hooks/use-correct-incorrect-quiz';\r\n\r\nlet lastScrollDate = 0;\r\nconst lethargy = new Lethargy();\r\n\r\ninterface Props {\r\n\tapplyLogic: boolean;\r\n\tisActive: boolean;\r\n}\r\n\r\nconst FieldsWrapper: React.FC< Props > = ( { applyLogic, isActive } ) => {\r\n\tconst { beforeGoingNext, isPreview, formId } = useFormContext();\r\n\tconst blocks = useBlocks();\r\n\tconst blockTypes = useBlockTypes();\r\n\tconst logic = useLogic();\r\n\tconst hiddenFields = useHiddenFields();\r\n\tconst correctIncorrectQuiz = useCorrectIncorrectQuiz();\r\n\tconst settings = useFormSettings();\r\n\tconst { formObj } = useFormContext();\r\n\t// @ts-ignore saveandcontinue is a property of formObj.\r\n\tconst { saveandcontinue = {} } = formObj;\r\n\t// @ts-ignore saved_data is a property of formObj.\r\n\tconst { saved_data = {} } = formObj;\r\n\tconst editableFields = useEditableFields( true );\r\n\r\n\tconst ref = useRef< HTMLDivElement | null >( null );\r\n\tconst { swiper } = useSelect( ( select ) => {\r\n\t\treturn {\r\n\t\t\tswiper: select( 'quillForms/renderer-core' ).getSwiperState(),\r\n\t\t};\r\n\t} );\r\n\r\n\tconst {\r\n\t\twalkPath,\r\n\t\tcurrentBlockId,\r\n\t\tnextBlockId,\r\n\t\tprevBlockId,\r\n\t\tlastActiveBlockId,\r\n\t\tcanSwipeNext,\r\n\t\tcanSwipePrev,\r\n\t\tisAnimating,\r\n\t\tisCurrentBlockSafeToSwipe,\r\n\t} = swiper;\r\n\r\n\tconst { answers } = useSelect( ( select ) => {\r\n\t\treturn {\r\n\t\t\tanswers: select( 'quillForms/renderer-core' ).getAnswers(),\r\n\t\t};\r\n\t} );\r\n\tconst currentBlockIndex = walkPath.findIndex(\r\n\t\t( block ) => block.id === currentBlockId\r\n\t);\r\n\r\n\tconst { nextBlock } = useSelect( ( select ) => {\r\n\t\treturn {\r\n\t\t\tnextBlock: nextBlockId\r\n\t\t\t\t? select( 'quillForms/renderer-core' ).getBlockById(\r\n\t\t\t\t\t\tnextBlockId\r\n\t\t\t\t  )\r\n\t\t\t\t: undefined,\r\n\t\t};\r\n\t} );\r\n\tconst currentBlockName = walkPath[ currentBlockIndex ]?.name;\r\n\r\n\tconst currentBlockType = blockTypes?.[ currentBlockName ];\r\n\r\n\tconst lastActiveBlockIndex = walkPath.findIndex(\r\n\t\t( block ) => block.id === lastActiveBlockId\r\n\t);\r\n\r\n\tconst {\r\n\t\tsetSwiper,\r\n\t\tgoNext,\r\n\t\tgoPrev,\r\n\t\tgoToBlock,\r\n\t\tsetIsCurrentBlockSafeToSwipe,\r\n\t\tsetIsFieldValid,\r\n\t\tsetIsFieldPending,\r\n\t\tsetFieldValidationErr,\r\n\t\tsetFieldAnswer,\r\n\t\tsetCorrectIncorrectDisplay,\r\n\t\tsetIsFieldCorrectIncorrectScreenDisplayed,\r\n\t} = useDispatch( 'quillForms/renderer-core' );\r\n\r\n\tuseEffect( () => {\r\n\t\tif ( saveandcontinue?.enable && saved_data?.snapshot ) {\r\n\t\t\tconst fields = saved_data?.fields || {};\r\n\r\n\t\t\tObject.keys( fields ).forEach( ( fieldId ) => {\r\n\t\t\t\tsetFieldAnswer( fieldId, fields[ fieldId ].value );\r\n\t\t\t} );\r\n\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif ( settings?.saveAnswersInBrowser && ! isPreview ) {\r\n\t\t\t// replace localstorage with cookies.\r\n\t\t\tconst answers = Cookies.get( `quillforms-answers-${ formId }` )\r\n\t\t\t\t? JSON.parse( Cookies.get( `quillforms-answers-${ formId }` ) )\r\n\t\t\t\t: {};\r\n\t\t\teditableFields.forEach( ( field ) => {\r\n\t\t\t\tif ( answers[ field.id ] ) {\r\n\t\t\t\t\tsetFieldAnswer( field.id, answers[ field.id ].value );\r\n\t\t\t\t}\r\n\t\t\t} );\r\n\t\t}\r\n\t}, [] );\r\n\r\n\tuseEffect( () => {\r\n\t\tif ( ! isPreview && settings?.saveAnswersInBrowser ) {\r\n\t\t\t// replace localstorage with cookies which will expire in 30 days.\r\n\t\t\tCookies.set(\r\n\t\t\t\t`quillforms-answers-${ formId }`,\r\n\t\t\t\tJSON.stringify( answers ),\r\n\t\t\t\t{ expires: 30 },\r\n\t\t\t\t{ path: '/' }\r\n\t\t\t);\r\n\t\t\tCookies.set(\r\n\t\t\t\t`quillforms-current-block-${ formId }`,\r\n\t\t\t\tcurrentBlockId,\r\n\t\t\t\t{ expires: 30 },\r\n\t\t\t\t{ path: '/' }\r\n\t\t\t);\r\n\t\t}\r\n\t}, [ currentBlockId, answers ] );\r\n\tconst isTouchScreen =\r\n\t\t( typeof window !== 'undefined' && 'ontouchstart' in window ) ||\r\n\t\t( typeof navigator !== 'undefined' && navigator.maxTouchPoints > 0 ) || // @ts-expect-error\r\n\t\t( typeof navigator !== 'undefined' && navigator.msMaxTouchPoints > 0 );\r\n\r\n\tconst getFieldsToRender = (): string[] => {\r\n\t\tconst fieldIds: string[] = [];\r\n\t\tconst filteredBlocks = walkPath.filter(\r\n\t\t\t( block ) =>\r\n\t\t\t\tanswers[ block.id ]?.isPending ||\r\n\t\t\t\tblock.id === currentBlockId ||\r\n\t\t\t\t( ! isTouchScreen && block.id === nextBlockId ) ||\r\n\t\t\t\t( ! isTouchScreen && block.id === prevBlockId ) ||\r\n\t\t\t\t( ! isTouchScreen && block.id === lastActiveBlockId )\r\n\t\t);\r\n\t\tfilteredBlocks.forEach( ( block ) => {\r\n\t\t\tif (\r\n\t\t\t\tblock.name !== 'welcome-screen' &&\r\n\t\t\t\tblock.name !== 'thankyou-screen'\r\n\t\t\t) {\r\n\t\t\t\tfieldIds.push( block.id );\r\n\t\t\t}\r\n\t\t} );\r\n\t\treturn fieldIds;\r\n\t};\r\n\r\n\tconst fieldsToRender = getFieldsToRender();\r\n\tconst fields = walkPath.filter(\r\n\t\t( block ) =>\r\n\t\t\tblock.name !== 'welcome-screen' && block.name !== 'thankyou-screen'\r\n\t);\r\n\r\n\tconst goNextReally = async () => {\r\n\t\tif ( answers[ currentBlockIndex ]?.isPending ) return;\r\n\t\tif ( beforeGoingNext && currentBlockId ) {\r\n\t\t\tawait beforeGoingNext( {\r\n\t\t\t\tanswers,\r\n\t\t\t\tcurrentBlockId,\r\n\t\t\t\tsetIsFieldValid,\r\n\t\t\t\tsetFieldValidationErr,\r\n\t\t\t\tsetIsCurrentBlockSafeToSwipe,\r\n\t\t\t\tgoToBlock,\r\n\t\t\t\tgoNext,\r\n\t\t\t\tsetIsPending: ( val ) =>\r\n\t\t\t\t\tsetIsFieldPending( currentBlockId, val ),\r\n\t\t\t} );\r\n\t\t} else {\r\n\t\t\tif (\r\n\t\t\t\tcorrectIncorrectQuiz?.enabled &&\r\n\t\t\t\tswiper?.correctIncorrectDisplay === false &&\r\n\t\t\t\tcurrentBlockType.supports.correctAnswers &&\r\n\t\t\t\tcorrectIncorrectQuiz?.showAnswersDuringQuiz &&\r\n\t\t\t\t! answers[ currentBlockId ]?.isCorrectIncorrectScreenDisplayed\r\n\t\t\t) {\r\n\t\t\t\tsetCorrectIncorrectDisplay( true );\r\n\t\t\t\tsetIsFieldCorrectIncorrectScreenDisplayed(\r\n\t\t\t\t\tcurrentBlockId,\r\n\t\t\t\t\ttrue\r\n\t\t\t\t);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tgoNext();\r\n\t\t}\r\n\t};\r\n\r\n\tconst { isCurrentBlockValid } = useSelect( ( select ) => {\r\n\t\treturn {\r\n\t\t\tisCurrentBlockValid: currentBlockType?.supports?.innerBlocks\r\n\t\t\t\t? select( 'quillForms/renderer-core' )?.hasValidFields(\r\n\t\t\t\t\t\t// @ts-expect-error\r\n\t\t\t\t\t\tcurrentBlockId\r\n\t\t\t\t  )\r\n\t\t\t\t: currentBlockType?.supports?.editable\r\n\t\t\t\t? select( 'quillForms/renderer-core' )?.isValidField(\r\n\t\t\t\t\t\t// @ts-expect-error\r\n\t\t\t\t\t\tcurrentBlockId\r\n\t\t\t\t  )\r\n\t\t\t\t: true,\r\n\t\t};\r\n\t} );\r\n\tuseEffect( () => {\r\n\t\tif ( isCurrentBlockSafeToSwipe ) setIsCurrentBlockSafeToSwipe( true );\r\n\t}, [ isCurrentBlockValid ] );\r\n\r\n\tconst isFirstField =\r\n\t\twalkPath?.length > 0 && walkPath[ 0 ].id === currentBlockId;\r\n\r\n\tconst isLastField =\r\n\t\twalkPath?.length &&\r\n\t\tcurrentBlockId === walkPath[ walkPath.length - 1 ].id;\r\n\r\n\tconst handlers = useSwipeable( {\r\n\t\tonSwiping: ( e ) => {\r\n\t\t\tswipingHandler( e, true );\r\n\t\t},\r\n\t\tpreventDefaultTouchmoveEvent: false,\r\n\t\ttrackMouse: false,\r\n\t\ttrackTouch: true,\r\n\t\tdelta: 70,\r\n\t} );\r\n\r\n\t// Mouse Wheel Handler\r\n\tconst swipingHandler = (\r\n\t\te: React.WheelEvent | SwipeEventData,\r\n\t\ttouch = false\r\n\t) => {\r\n\t\tif ( settings?.disableWheelSwiping ) return;\r\n\t\tlet delta = e.deltaY;\r\n\t\tif ( settings?.animationDirection === 'horizontal' ) {\r\n\t\t\tdelta = e.deltaX;\r\n\t\t}\r\n\t\tif ( swiper.isAnimating ) return;\r\n\t\tconst lethargyCheck = lethargy.check( e );\r\n\t\tconst now = new Date().getTime();\r\n\t\tlet timeDelay = 900;\r\n\t\tif ( touch ) timeDelay = 500;\r\n\t\tif (\r\n\t\t\tlethargyCheck === false ||\r\n\t\t\tisAnimating ||\r\n\t\t\t( lastScrollDate && now - lastScrollDate < timeDelay )\r\n\t\t)\r\n\t\t\treturn;\r\n\t\tif (\r\n\t\t\tcanSwipePrev &&\r\n\t\t\t( ( delta < -50 && ! touch ) ||\r\n\t\t\t\t( touch &&\r\n\t\t\t\t\tdelta > 50 &&\r\n\t\t\t\t\t( e as SwipeEventData ).dir === 'Down' ) ) &&\r\n\t\t\t! isFirstField\r\n\t\t) {\r\n\t\t\t// Scroll up\r\n\t\t\tlastScrollDate = new Date().getTime();\r\n\t\t\tgoPrev();\r\n\t\t} else if (\r\n\t\t\tcanSwipeNext &&\r\n\t\t\t( ( delta < -50 &&\r\n\t\t\t\ttouch &&\r\n\t\t\t\t( e as SwipeEventData ).dir === 'Up' ) ||\r\n\t\t\t\t( ! touch && delta > 50 ) ) &&\r\n\t\t\t! isLastField\r\n\t\t) {\r\n\t\t\tlastScrollDate = new Date().getTime();\r\n\t\t\t// Scroll down\r\n\t\t\tif ( isCurrentBlockValid ) {\r\n\t\t\t\tgoNextReally();\r\n\t\t\t} else {\r\n\t\t\t\tsetIsCurrentBlockSafeToSwipe( false );\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tuseEffect( (): void | ( () => void ) => {\r\n\t\tif ( isAnimating ) {\r\n\t\t\tconst timer = setTimeout( () => {\r\n\t\t\t\tsetSwiper( {\r\n\t\t\t\t\tisAnimating: false,\r\n\t\t\t\t} );\r\n\t\t\t}, 600 );\r\n\t\t\treturn () => clearTimeout( timer );\r\n\t\t}\r\n\t}, [ swiper ] );\r\n\r\n\tuseEffect( () => {\r\n\t\tif ( applyLogic && isActive ) {\r\n\t\t\tdoAction(\r\n\t\t\t\t'QuillForms.RendererCore.LogicApply',\r\n\t\t\t\tblocks,\r\n\t\t\t\tblockTypes,\r\n\t\t\t\tlogic,\r\n\t\t\t\thiddenFields\r\n\t\t\t);\r\n\t\t}\r\n\t}, [ answers, currentBlockId ] );\r\n\r\n\tuseEffect( () => {\r\n\t\tif ( applyLogic && isActive ) {\r\n\t\t\tsetSwiper( {\r\n\t\t\t\tcurrentBlockId: blocks[ 0 ].id,\r\n\t\t\t\tprevBlockId: undefined,\r\n\t\t\t\tcanSwipePrev: false,\r\n\t\t\t\tlastActiveBlockId: undefined,\r\n\t\t\t} );\r\n\t\t\tdoAction(\r\n\t\t\t\t'QuillForms.RendererCore.LogicApply',\r\n\t\t\t\tblocks,\r\n\t\t\t\tblockTypes,\r\n\t\t\t\tlogic,\r\n\t\t\t\thiddenFields\r\n\t\t\t);\r\n\t\t}\r\n\t\tif ( ! applyLogic ) {\r\n\t\t\tdoAction( 'QuillForms.RendererCore.LogicTurnOff' );\r\n\t\t}\r\n\t}, [ applyLogic ] );\r\n\r\n\t// const isThereNextField =\r\n\t// \tfields.filter( ( field ) => field.id === nextBlockId ).length === 0;\r\n\r\n\tconst handleNext = () => {\r\n\t\tif ( isCurrentBlockValid ) {\r\n\t\t\tgoNextReally();\r\n\t\t} else {\r\n\t\t\tsetIsCurrentBlockSafeToSwipe( false );\r\n\t\t}\r\n\t};\r\n\treturn (\r\n\t\t<div\r\n\t\t\tonWheel={ swipingHandler }\r\n\t\t\tclassName={ classNames( 'renderer-core-fields-wrapper', {\r\n\t\t\t\tactive: isActive,\r\n\t\t\t\t'is-moving-up':\r\n\t\t\t\t\tisAnimating && currentBlockIndex < lastActiveBlockIndex,\r\n\t\t\t\t'is-moving-down':\r\n\t\t\t\t\tisAnimating && currentBlockIndex > lastActiveBlockIndex,\r\n\t\t\t} ) }\r\n\t\t\tref={ ref }\r\n\t\t\taria-hidden={ isActive ? false : true }\r\n\t\t>\r\n\t\t\t<div { ...handlers }>\r\n\t\t\t\t{ fields.map( ( field, index ) => {\r\n\t\t\t\t\tconst isActive = currentBlockId === field.id;\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t<FieldRender\r\n\t\t\t\t\t\t\tkey={ `${ field.id }` }\r\n\t\t\t\t\t\t\tid={ field.id }\r\n\t\t\t\t\t\t\tshouldBeRendered={ fieldsToRender.includes(\r\n\t\t\t\t\t\t\t\tfield.id\r\n\t\t\t\t\t\t\t) }\r\n\t\t\t\t\t\t\tisActive={ isActive }\r\n\t\t\t\t\t\t\tisCurrentBlockSafeToSwipe={\r\n\t\t\t\t\t\t\t\tisActive ? isCurrentBlockSafeToSwipe : true\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tisLastField={\r\n\t\t\t\t\t\t\t\t( ! nextBlock ||\r\n\t\t\t\t\t\t\t\t\tnextBlock.name === 'thankyou-screen' ) &&\r\n\t\t\t\t\t\t\t\tindex === fields.length - 1\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tnext={ () => handleNext() }\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t);\r\n\t\t\t\t} ) }\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\nexport default FieldsWrapper;\r\n"],"mappings":"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","ignoreList":[]}