{"version":3,"names":["useGeneralTheme","configApi","useState","useDispatch","classnames","TailSpin","Loader","css","Coupon","data","_data$payments$labels","_data$payments$labels2","_data$payments$labels3","generalTheme","isPaying","setIsPaying","showCoupon","setShowCoupon","coupon","setCoupon","error","setError","setPaymentData","applyCoupon","submission_id","hashed_id","response","fetch","getAdminUrl","method","body","URLSearchParams","action","submissionId","hashedId","result","json","success","UpdatedData","payments","discount_details","details","e","console","log","message","Error","createElement","className","questionsColor","onClick","labels","discountQuestion","type","placeholder","discountPlaceholde","style","color","border","borderRadius","fontSize","padding","lineHeight","background","value","onChange","target","loading","buttonsBgColor","buttonsFontColor","id","height","width","Fragment","applyDiscount"],"sources":["@quillforms/renderer-core/src/components/payment-modal/coupon/index.tsx"],"sourcesContent":["/**\r\n * QuillForms Dependencies\r\n */\r\nimport useGeneralTheme from '../../../hooks/use-general-theme';\r\nimport configApi from '@quillforms/config';\r\n\r\n/**\r\n * WordPress Dependencies\r\n */\r\nimport { __ } from '@wordpress/i18n';\r\nimport { useState } from '@wordpress/element';\r\nimport { useDispatch } from '@wordpress/data';\r\n\r\n/**\r\n * External Dependencies\r\n */\r\nimport classnames from 'classnames';\r\nimport { TailSpin as Loader } from 'react-loader-spinner';\r\nimport { css } from 'emotion';\r\n\r\ninterface Props {\r\n\tdata: any;\r\n}\r\n\r\nconst Coupon: React.FC<Props> = ({ data }) => {\r\n\tconst generalTheme = useGeneralTheme();\r\n\tconst [isPaying, setIsPaying] = useState(false);\r\n\tconst [showCoupon, setShowCoupon] = useState(false);\r\n\tconst [coupon, setCoupon] = useState('');\r\n\tconst [error, setError] = useState('');\r\n\tconst { setPaymentData } = useDispatch('quillForms/renderer-core');\r\n\r\n\tconst applyCoupon = async () => {\r\n\t\tsetError('');\r\n\t\tsetIsPaying(true);\r\n\t\ttry {\r\n\t\t\tconst { submission_id, hashed_id } = data;\r\n\t\t\tlet response = await fetch(\r\n\t\t\t\tconfigApi.getAdminUrl() + 'admin-ajax.php',\r\n\t\t\t\t{\r\n\t\t\t\t\tmethod: 'POST',\r\n\t\t\t\t\tbody: new URLSearchParams({\r\n\t\t\t\t\t\taction: 'quillforms_apply_discount',\r\n\t\t\t\t\t\tsubmissionId: submission_id,\r\n\t\t\t\t\t\thashedId: hashed_id,\r\n\t\t\t\t\t\tcoupon,\r\n\t\t\t\t\t}),\r\n\t\t\t\t}\r\n\t\t\t);\r\n\r\n\t\t\tlet result = await response.json();\r\n\t\t\tif (result.success) {\r\n\t\t\t\t// Update new products\r\n\t\t\t\tconst UpdatedData = { ...data };\r\n\t\t\t\tUpdatedData.payments.discount_details = result.data.details;\r\n\t\t\t\tUpdatedData.payments.discount_details['coupon'] = coupon;\r\n\t\t\t\tsetPaymentData(UpdatedData);\r\n\t\t\t} else {\r\n\t\t\t\tsetError(result.data);\r\n\t\t\t}\r\n\t\t} catch (e) {\r\n\t\t\tconsole.log('applyCoupon: error throwed', e);\r\n\t\t\treturn {\r\n\t\t\t\tsuccess: false,\r\n\t\t\t\tmessage:\r\n\t\t\t\t\te instanceof Error && e.message\r\n\t\t\t\t\t\t? e.message\r\n\t\t\t\t\t\t: 'Unexpected error',\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\tsetIsPaying(false);\r\n\t\tsetCoupon('');\r\n\t};\r\n\treturn (\r\n\t\t<div className=\"renderer-core-payment-coupon\">\r\n\t\t\t<div\r\n\t\t\t\tclassName={classnames(\"renderer-core-payment-coupon__label\", css`\r\n\t\t\t\t\tcolor: ${generalTheme.questionsColor};\r\n\t\t\t\t`)}\r\n\t\t\t\tonClick={() => setShowCoupon(true)}\r\n\t\t\t>\r\n\t\t\t\t{data.payments.labels?.discountQuestion ?? 'You have a coupon?'}\r\n\t\t\t</div>\r\n\t\t\t{showCoupon && (\r\n\t\t\t\t<div className=\"render-core-payment-coupon-form\">\r\n\t\t\t\t\t<div className=\"renderer-core-payment-coupon__input\">\r\n\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\tplaceholder={data.payments.labels?.discountPlaceholde ?? 'Enter your discount code'}\r\n\t\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\t\tcolor: '#333',\r\n\t\t\t\t\t\t\t\tborder: `1px solid rgba(0, 0, 0, 0.3)`,\r\n\t\t\t\t\t\t\t\tborderRadius: '8px',\r\n\t\t\t\t\t\t\t\tfontSize: '16px',\r\n\t\t\t\t\t\t\t\tpadding: '10px 20px',\r\n\t\t\t\t\t\t\t\tlineHeight: '1',\r\n\t\t\t\t\t\t\t\tbackground: \"#fff\"\r\n\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\tclassName={classnames(\r\n\t\t\t\t\t\t\t\tcss`\r\n\t\t\t\t\t\t\t\t\t&:focus {\r\n\t\t\t\t\t\t\t\t\t\toutline: none;\r\n\t\t\t\t\t\t\t\t\t\tborder: 1px solid rgba( 0, 0, 0, 0.3 );\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t`\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\tvalue={coupon}\r\n\t\t\t\t\t\t\tonChange={(e) => setCoupon(e.target.value)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"renderer-core-payment-coupon__apply\">\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tclassName={classnames(\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tloading: isPaying,\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\tcss`\r\n\t\t\t\t\t\t\t\t\tborder-radius: 8px;\r\n\t\t\t\t\t\t\t\t\tbackground: ${generalTheme.buttonsBgColor};\r\n\t\t\t\t\t\t\t\t\tcolor: ${generalTheme.buttonsFontColor};\r\n\t\t\t\t\t\t\t\t\tborder: none;\r\n\t\t\t\t\t\t\t\t\tpadding: 10px 20px;\r\n\t\t\t\t\t\t\t\t\tfont-size: 16px;\r\n\t\t\t\t\t\t\t\t\tcursor: pointer;\r\n\t\t\t\t\t\t\t\t\t&.loading .renderer-core-arrow-icon {\r\n\t\t\t\t\t\t\t\t\t\tdisplay: none;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t`,\r\n\t\t\t\t\t\t\t\t'apply-coupon-button'\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\tonClick={() => applyCoupon()}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<span id=\"button-text\">\r\n\t\t\t\t\t\t\t\t{isPaying ? (\r\n\t\t\t\t\t\t\t\t\t<Loader\r\n\t\t\t\t\t\t\t\t\t\tcolor={generalTheme.buttonsFontColor}\r\n\t\t\t\t\t\t\t\t\t\theight={16}\r\n\t\t\t\t\t\t\t\t\t\twidth={16}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t<>{data.payments.labels?.applyDiscount ?? 'apply'} </>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\t\t\t{error && (\r\n\t\t\t\t<div\r\n\t\t\t\t\tclassName={classnames(\r\n\t\t\t\t\t\t'renderer-core-payment-coupon__error',\r\n\t\t\t\t\t\tcss`\r\n\t\t\t\t\t\t\tcolor: #a94442;\r\n\t\t\t\t\t\t\tfont-size: 14px;\r\n\t\t\t\t\t\t\tmargin-top: 10px;\r\n\t\t\t\t\t\t`\r\n\t\t\t\t\t)}\r\n\t\t\t\t>\r\n\t\t\t\t\t{error}\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default Coupon;\r\n"],"mappings":"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","ignoreList":[]}