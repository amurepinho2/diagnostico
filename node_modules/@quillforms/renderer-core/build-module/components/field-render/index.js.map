{"version":3,"names":["useState","useEffect","useSelect","useDispatch","FieldRenderContextProvider","__experimentalUseFieldRenderContext","FieldWrapper","FieldRender","id","isActive","isLastField","shouldBeRendered","isCurrentBlockSafeToSwipe","next","isSubmitBtnVisible","showNextBtn","isErrMsgVisible","showErrMsg","isReviewing","isValid","block","firstInvalidFieldId","lastFieldId","select","walkPath","getWalkPath","isValidField","getBlockById","getFirstInvalidFieldId","length","goToBlock","setIsCurrentBlockSafeToSwipe","name","attributes","innerBlocks","context","blockName","createElement","value"],"sources":["@quillforms/renderer-core/src/components/field-render/index.tsx"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { useState, useEffect } from '@wordpress/element';\r\nimport { useSelect, useDispatch } from '@wordpress/data';\r\n/**\r\n * Internal dependencies\r\n */\r\nimport {\r\n\tFieldRenderContextProvider,\r\n\t__experimentalUseFieldRenderContext,\r\n} from './context';\r\nimport FieldWrapper from '../field-wrapper';\r\n\r\nexport { __experimentalUseFieldRenderContext };\r\n\r\ninterface Props {\r\n\tid: string;\r\n\tisActive: boolean;\r\n\tshouldBeRendered: boolean;\r\n\tisLastField: boolean;\r\n\tisCurrentBlockSafeToSwipe: boolean;\r\n\tnext: Function;\r\n}\r\n\r\nconst FieldRender: React.FC<Props> =\r\n\t({\r\n\t\tid,\r\n\t\tisActive,\r\n\t\tisLastField,\r\n\t\tshouldBeRendered,\r\n\t\tisCurrentBlockSafeToSwipe,\r\n\t\tnext,\r\n\t}) => {\r\n\t\tconst [isSubmitBtnVisible, showNextBtn] = useState<boolean>(true);\r\n\t\tconst [isErrMsgVisible, showErrMsg] = useState<boolean>(false);\r\n\r\n\t\tconst {\r\n\t\t\tisReviewing,\r\n\t\t\tisValid,\r\n\t\t\tblock,\r\n\t\t\tfirstInvalidFieldId,\r\n\t\t\tlastFieldId,\r\n\t\t} = useSelect((select) => {\r\n\t\t\tconst walkPath = select('quillForms/renderer-core').getWalkPath();\r\n\t\t\treturn {\r\n\t\t\t\tisReviewing: select('quillForms/renderer-core').isReviewing(),\r\n\t\t\t\tisValid: select('quillForms/renderer-core').isValidField(\r\n\t\t\t\t\tid\r\n\t\t\t\t),\r\n\t\t\t\tblock: select('quillForms/renderer-core').getBlockById(id),\r\n\t\t\t\tfirstInvalidFieldId: select(\r\n\t\t\t\t\t'quillForms/renderer-core'\r\n\t\t\t\t).getFirstInvalidFieldId(),\r\n\t\t\t\tlastFieldId: walkPath[walkPath.length - 1].id,\r\n\t\t\t};\r\n\t\t});\r\n\r\n\t\tconst { goToBlock, setIsCurrentBlockSafeToSwipe } = useDispatch(\r\n\t\t\t'quillForms/renderer-core'\r\n\t\t);\r\n\r\n\t\tuseEffect(() => {\r\n\t\t\tif (isActive && !isReviewing && !isErrMsgVisible) {\r\n\t\t\t\tshowErrMsg(false);\r\n\t\t\t\tsetIsCurrentBlockSafeToSwipe(true);\r\n\t\t\t}\r\n\t\t}, [isActive, isErrMsgVisible, isReviewing]);\r\n\r\n\t\tuseEffect(() => {\r\n\t\t\tif (!isCurrentBlockSafeToSwipe) {\r\n\t\t\t\tshowErrMsg(true);\r\n\t\t\t}\r\n\t\t}, [isCurrentBlockSafeToSwipe]);\r\n\t\tuseEffect(() => {\r\n\t\t\tif (isReviewing && !isValid) {\r\n\t\t\t\tshowErrMsg(true);\r\n\t\t\t}\r\n\t\t}, [isReviewing, isValid]);\r\n\r\n\t\tif (!block) return null;\r\n\t\t//console.log( block );\r\n\t\tconst { name, attributes, innerBlocks } = block;\r\n\r\n\t\tconst context = {\r\n\t\t\tid,\r\n\t\t\tblockName: name,\r\n\t\t\tattributes,\r\n\t\t\tinnerBlocks,\r\n\t\t\tisActive,\r\n\t\t\tshouldBeRendered,\r\n\t\t\tisErrMsgVisible,\r\n\t\t\tshowErrMsg,\r\n\t\t\tisSubmitBtnVisible,\r\n\t\t\tshowNextBtn,\r\n\t\t\tnext: () => {\r\n\t\t\t\tif (!isReviewing) {\r\n\t\t\t\t\tnext();\r\n\t\t\t\t} else if (firstInvalidFieldId) {\r\n\t\t\t\t\tgoToBlock(firstInvalidFieldId);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tgoToBlock(lastFieldId);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tisLastField,\r\n\t\t};\r\n\t\treturn (\r\n\t\t\t<FieldRenderContextProvider value={context}>\r\n\t\t\t\t<FieldWrapper />\r\n\t\t\t</FieldRenderContextProvider>\r\n\t\t);\r\n\t};\r\n\r\nexport default FieldRender;\r\n"],"mappings":"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","ignoreList":[]}